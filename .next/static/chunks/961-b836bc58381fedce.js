(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[961],{1739:function(e,t,r){"use strict";let n,i;r.d(t,{nx:function(){return nA}});var s,o,a,c,l,u,h,d,p,f,v,y,m,g,T,E={};r.r(E),r.d(E,{e4:function(){return eV},f0:function(){return eF},al:function(){return eL},aT:function(){return eB},Sl:function(){return e$},vU:function(){return eK},o$:function(){return eO},bf:function(){return e_},pure:function(){return eq},OU:function(){return eC},yC:function(){return eH},lW:function(){return eP},sendParent:function(){return eU},BL:function(){return eM},sT:function(){return ej},Q8:function(){return eN},AE:function(){return eR},XA:function(){return eD}});class S extends Error{}function w(e,t){let r;if("string"!=typeof e)throw new S("Invalid token specified: must be a string");t||(t={});let n=!0===t.header?0:1,i=e.split(".")[n];if("string"!=typeof i)throw new S(`Invalid token specified: missing part #${n+1}`);try{r=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var r;return r=t,decodeURIComponent(atob(r).replace(/(.)/g,(e,t)=>{let r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}catch(e){return atob(t)}}(i)}catch(e){throw new S(`Invalid token specified: invalid base64 for part #${n+1} (${e.message})`)}try{return JSON.parse(r)}catch(e){throw new S(`Invalid token specified: invalid json for part #${n+1} (${e.message})`)}}S.prototype.name="InvalidTokenError";var k=function(){return(k=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function b(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function x(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function I(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}function A(e,t,r){if(r||2==arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}(s=d||(d={})).Start="xstate.start",s.Stop="xstate.stop",s.Raise="xstate.raise",s.Send="xstate.send",s.Cancel="xstate.cancel",s.NullEvent="",s.Assign="xstate.assign",s.After="xstate.after",s.DoneState="done.state",s.DoneInvoke="done.invoke",s.Log="xstate.log",s.Init="xstate.init",s.Invoke="xstate.invoke",s.ErrorExecution="error.execution",s.ErrorCommunication="error.communication",s.ErrorPlatform="error.platform",s.ErrorCustom="xstate.error",s.Update="xstate.update",s.Pure="xstate.pure",s.Choose="xstate.choose",(o=p||(p={})).Parent="#_parent",o.Internal="#_internal";var _=d.Start,O=d.Stop,N=d.Raise,R=d.Send,D=d.Cancel,C=d.NullEvent,P=d.Assign;d.After,d.DoneState;var U=d.Log,L=d.Init,M=d.Invoke;d.ErrorExecution;var j=d.ErrorPlatform,F=d.ErrorCustom,V=d.Update,B=d.Choose,$=d.Pure,K={},q="xstate.guard";function G(e,t,r){void 0===r&&(r=".");var n=z(e,r),i=z(t,r);return ec(i)?!!ec(n)&&i===n:ec(n)?n in i:Object.keys(n).every(function(e){return e in i&&G(n[e],i[e])})}function H(e){try{return ec(e)||"number"==typeof e?"".concat(e):e.type}catch(e){throw Error("Events must be strings or objects with a string event.type property.")}}function Y(e,t){try{if(eo(e))return e;return e.toString().split(t)}catch(t){throw Error("'".concat(e,"' is not a valid state path."))}}function z(e,t){return"object"==typeof e&&"value"in e&&"context"in e&&"event"in e&&"_event"in e?e.value:eo(e)?J(e):"string"!=typeof e?e:J(Y(e,t))}function J(e){if(1===e.length)return e[0];for(var t={},r=t,n=0;n<e.length-1;n++)n===e.length-2?r[e[n]]=e[n+1]:(r[e[n]]={},r=r[e[n]]);return t}function W(e,t){for(var r={},n=Object.keys(e),i=0;i<n.length;i++){var s=n[i];r[s]=t(e[s],s,e,i)}return r}function Q(e,t,r){var n,i,s={};try{for(var o=x(Object.keys(e)),a=o.next();!a.done;a=o.next()){var c=a.value,l=e[c];r(l)&&(s[c]=t(l,c,e))}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}var X=function(e){return function(t){var r,n,i=t;try{for(var s=x(e),o=s.next();!o.done;o=s.next())i=i[o.value]}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i}};function Z(e){return e?ec(e)?[[e]]:ee(Object.keys(e).map(function(t){var r=e[t];return"string"==typeof r||r&&Object.keys(r).length?Z(e[t]).map(function(e){return[t].concat(e)}):[[t]]})):[[]]}function ee(e){var t;return(t=[]).concat.apply(t,A([],I(e),!1))}function et(e){return void 0===e?[]:eo(e)?e:[e]}function er(e,t,r){if(ea(e))return e(t,r.data);var n,i,s={};try{for(var o=x(Object.keys(e)),a=o.next();!a.done;a=o.next()){var c=a.value,l=e[c];ea(l)?s[c]=l(t,r.data):s[c]=l}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}function en(e){return!!(e instanceof Promise||null!==e&&(ea(e)||"object"==typeof e)&&ea(e.then))}function ei(e,t,r,n){return e?r.reduce(function(e,r){var i,s,o=r.assignment,a={state:n,action:r,_event:t},c={};if(ea(o))c=o(e,t.data,a);else try{for(var l=x(Object.keys(o)),u=l.next();!u.done;u=l.next()){var h=u.value,d=o[h];c[h]=ea(d)?d(e,t.data,a):d}}catch(e){i={error:e}}finally{try{u&&!u.done&&(s=l.return)&&s.call(l)}finally{if(i)throw i.error}}return Object.assign({},e,c)},e):e}var es=function(){};function eo(e){return Array.isArray(e)}function ea(e){return"function"==typeof e}function ec(e){return"string"==typeof e}function el(e,t){return e?ec(e)?{type:q,name:e,predicate:t?t[e]:void 0}:ea(e)?{type:q,name:e.name,predicate:e}:e:void 0}var eu="function"==typeof Symbol&&Symbol.observable||"@@observable";function eh(e){return!!e&&"__xstatenode"in e}function ed(e,t){return ec(e)||"number"==typeof e?k({type:e},t):e}function ep(e,t){if(!ec(e)&&"$$type"in e&&"scxml"===e.$$type)return e;var r=ed(e);return k({name:r.type,data:r,$$type:"scxml",type:"external"},t)}function ef(e,t){return(eo(t)?t:[t]).map(function(t){return void 0===t||"string"==typeof t||eh(t)?{target:t,event:e}:k(k({},t),{event:e})})}function ev(e,t,r,n,i){var s=e.options.guards,o={state:i,cond:t,_event:n};if(t.type===q)return((null==s?void 0:s[t.name])||t.predicate)(r,n.data,o);var a=null==s?void 0:s[t.type];if(!a)throw Error("Guard '".concat(t.type,"' is not implemented on machine '").concat(e.id,"'."));return a(r,n.data,o)}function ey(e){return"string"==typeof e?{type:e}:e}function em(e,t,r){var n=function(){},i="object"==typeof e,s=i?e:null;return{next:((i?e.next:e)||n).bind(s),error:((i?e.error:t)||n).bind(s),complete:((i?e.complete:r)||n).bind(s)}}function eg(e,t){return"".concat(e,":invocation[").concat(t,"]")}function eT(e){return(e.type===N||e.type===R&&e.to===p.Internal)&&"number"!=typeof e.delay}(f={})[eu]=function(){return this},f[Symbol.observable]=function(){return this};var eE=function(e){return"atomic"===e.type||"final"===e.type};function eS(e){return Object.keys(e.states).map(function(t){return e.states[t]})}function ew(e){return eS(e).filter(function(e){return"history"!==e.type})}function ek(e,t){var r,n,i,s,o,a,c,l,u=eb(new Set(e)),h=new Set(t);try{for(var d=x(h),p=d.next();!p.done;p=d.next())for(var f=p.value,v=f.parent;v&&!h.has(v);)h.add(v),v=v.parent}catch(e){r={error:e}}finally{try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}var y=eb(h);try{for(var m=x(h),g=m.next();!g.done;g=m.next()){var f=g.value;if("compound"!==f.type||y.get(f)&&y.get(f).length){if("parallel"===f.type)try{for(var T=(o=void 0,x(ew(f))),E=T.next();!E.done;E=T.next()){var S=E.value;h.has(S)||(h.add(S),u.get(S)?u.get(S).forEach(function(e){return h.add(e)}):S.initialStateNodes.forEach(function(e){return h.add(e)}))}}catch(e){o={error:e}}finally{try{E&&!E.done&&(a=T.return)&&a.call(T)}finally{if(o)throw o.error}}}else u.get(f)?u.get(f).forEach(function(e){return h.add(e)}):f.initialStateNodes.forEach(function(e){return h.add(e)})}}catch(e){i={error:e}}finally{try{g&&!g.done&&(s=m.return)&&s.call(m)}finally{if(i)throw i.error}}try{for(var w=x(h),k=w.next();!k.done;k=w.next())for(var f=k.value,v=f.parent;v&&!h.has(v);)h.add(v),v=v.parent}catch(e){c={error:e}}finally{try{k&&!k.done&&(l=w.return)&&l.call(w)}finally{if(c)throw c.error}}return h}function eb(e){var t,r,n=new Map;try{for(var i=x(e),s=i.next();!s.done;s=i.next()){var o=s.value;n.has(o)||n.set(o,[]),o.parent&&(n.has(o.parent)||n.set(o.parent,[]),n.get(o.parent).push(o))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n}function ex(e,t){return Array.isArray(e)?e.some(function(e){return e===t}):e instanceof Set&&e.has(t)}function eI(e,t){return"compound"===t.type?ew(t).some(function(t){return"final"===t.type&&ex(e,t)}):"parallel"===t.type&&ew(t).every(function(t){return eI(e,t)})}function eA(e){return new Set(ee(e.map(function(e){return e.tags})))}var e_=ep({type:L});function eO(e,t){return t&&t[e]||void 0}function eN(e,t){var r;if(ec(e)||"number"==typeof e){var n=eO(e,t);r=ea(n)?{type:e,exec:n}:n||{type:e,exec:void 0}}else if(ea(e))r={type:e.name||e.toString(),exec:e};else{var n=eO(e.type,t);if(ea(n))r=k(k({},e),{exec:n});else if(n){var i=n.type||e.type;r=k(k(k({},n),e),{type:i})}else r=e}return r}var eR=function(e,t){return e?(eo(e)?e:[e]).map(function(e){return eN(e,t)}):[]};function eD(e){var t=eN(e);return k(k({id:ec(e)?e:t.id},t),{type:t.type})}function eC(e,t){return{type:N,event:"function"==typeof e?e:ed(e),delay:t?t.delay:void 0,id:null==t?void 0:t.id}}function eP(e,t){return{to:t?t.to:void 0,type:R,event:ea(e)?e:ed(e),delay:t?t.delay:void 0,id:t&&void 0!==t.id?t.id:ea(e)?e.name:H(e)}}function eU(e,t){return eP(e,k(k({},t),{to:p.Parent}))}var eL=function(e){return{type:D,sendId:e}};function eM(e){var t=eD(e);return{type:d.Start,activity:t,exec:void 0}}function ej(e){var t=ea(e)?e:eD(e);return{type:d.Stop,activity:t,exec:void 0}}var eF=function(e){return{type:P,assignment:e}};function eV(e,t){return"".concat(d.After,"(").concat(e,")").concat(t?"#".concat(t):"")}function eB(e,t){var r="".concat(d.DoneState,".").concat(e),n={type:r,data:t};return n.toString=function(){return r},n}function e$(e,t){var r="".concat(d.DoneInvoke,".").concat(e),n={type:r,data:t};return n.toString=function(){return r},n}function eK(e,t){var r="".concat(d.ErrorPlatform,".").concat(e),n={type:r,data:t};return n.toString=function(){return r},n}function eq(e){return{type:d.Pure,get:e}}var eG=function(e){var t,r,n=[];try{for(var i=x(e),s=i.next();!s.done;s=i.next())for(var o=s.value,a=0;a<o.actions.length;){if(o.actions[a].type===P){n.push(o.actions[a]),o.actions.splice(a,1);continue}a++}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n};function eH(e,t,r,n,i,s,o){void 0===o&&(o=!1);var a=o?[]:eG(i),c=a.length?ei(r,n,a,t):r,l=o?[r]:void 0,u=[];return[ee(i.map(function(i){var a,h,f=[];try{for(var v=x(i.actions),y=v.next();!y.done;y=v.next()){var m=y.value,g=function(i,a){var h;switch(a.type){case N:var f=function(e,t,r,n){var i,s={_event:r},o=ep(ea(e.event)?e.event(t,r.data,s):e.event);if(ec(e.delay)){var a=n&&n[e.delay];i=ea(a)?a(t,r.data,s):a}else i=ea(e.delay)?e.delay(t,r.data,s):e.delay;return k(k({},e),{type:N,_event:o,delay:i})}(a,c,n,e.options.delays);return s&&"number"==typeof f.delay&&s(f,c,n),f;case R:var v=function(e,t,r,n){var i,s={_event:r},o=ep(ea(e.event)?e.event(t,r.data,s):e.event);if(ec(e.delay)){var a=n&&n[e.delay];i=ea(a)?a(t,r.data,s):a}else i=ea(e.delay)?e.delay(t,r.data,s):e.delay;var c=ea(e.to)?e.to(t,r.data,s):e.to;return k(k({},e),{to:c,_event:o,event:o.data,delay:i})}(a,c,n,e.options.delays);return s&&v.to!==p.Internal&&("entry"===i?u.push(v):s(v,c,n)),v;case U:var y,m=(y=c,k(k({},a),{value:ec(a.expr)?a.expr:a.expr(y,n.data,{_event:n})}));return null==s||s(m,c,n),m;case B:var g=null===(h=a.conds.find(function(r){var i=el(r.cond,e.options.guards);return!i||ev(e,i,c,n,s?void 0:t)}))||void 0===h?void 0:h.actions;if(!g)return[];var T=I(eH(e,t,c,n,[{type:i,actions:eR(et(g),e.options.actions)}],s,o),2),E=T[0];return c=T[1],null==l||l.push(c),E;case $:var g=a.get(c,n.data);if(!g)return[];var S=I(eH(e,t,c,n,[{type:i,actions:eR(et(g),e.options.actions)}],s,o),2),w=S[0];return c=S[1],null==l||l.push(c),w;case O:var b,x,m=(b=c,x=ea(a.activity)?a.activity(b,n.data):a.activity,{type:d.Stop,activity:"string"==typeof x?{id:x}:x});return null==s||s(m,r,n),m;case P:c=ei(c,n,[a],s?void 0:t),null==l||l.push(c);break;default:var _=eN(a,e.options.actions),D=_.exec;if(s)s(_,c,n);else if(D&&l){var C=l.length-1;_=k(k({},_),{exec:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];D.apply(void 0,A([l[C]],I(t),!1))}})}return _}}(i.type,m);g&&(f=f.concat(g))}}catch(e){a={error:e}}finally{try{y&&!y.done&&(h=v.return)&&h.call(v)}finally{if(a)throw a.error}}return u.forEach(function(e){s(e,c,n)}),u.length=0,f})),c]}var eY=function(){function e(e){var t,r,n=this;this.actions=[],this.activities=K,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||K,this.meta=(void 0===(t=e.configuration)&&(t=[]),t.reduce(function(e,t){return void 0!==t.meta&&(e[t.id]=t.meta),e},{})),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=null!==(r=Array.isArray(e.tags)?new Set(e.tags):e.tags)&&void 0!==r?r:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return A([],I(new Set(ee(A([],I(n.configuration.map(function(e){return e.ownEvents})),!1)))),!1)}})}return e.from=function(t,r){return t instanceof e?t.context!==r?new e({value:t.value,context:r,_event:t._event,_sessionid:null,historyValue:t.historyValue,history:t.history,actions:[],activities:t.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):t:new e({value:t,context:r,_event:e_,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},e.create=function(t){return new e(t)},e.inert=function(t,r){return t instanceof e?t.actions.length?new e({value:t.value,context:r,_event:e_,_sessionid:null,historyValue:t.historyValue,history:t.history,activities:t.activities,configuration:t.configuration,transitions:[],children:{}}):t:e.from(t,r)},e.prototype.toStrings=function(e,t){var r=this;if(void 0===e&&(e=this.value),void 0===t&&(t="."),ec(e))return[e];var n=Object.keys(e);return n.concat.apply(n,A([],I(n.map(function(n){return r.toStrings(e[n],t).map(function(e){return n+t+e})})),!1))},e.prototype.toJSON=function(){this.configuration,this.transitions;var e=this.tags;this.machine;var t=b(this,["configuration","transitions","tags","machine"]);return k(k({},t),{tags:Array.from(e)})},e.prototype.matches=function(e){return G(e,this.value)},e.prototype.hasTag=function(e){return this.tags.has(e)},e.prototype.can=function(e){es(!!this.machine,"state.can(...) used outside of a machine-created State object; this will always return false.");var t,r=null===(t=this.machine)||void 0===t?void 0:t.getTransitionData(this,e);return!!(null==r?void 0:r.transitions.length)&&r.transitions.some(function(e){return void 0!==e.target||e.actions.length})},e}(),ez=[],eJ=function(e,t){ez.push(e);var r=t(e);return ez.pop(),r};function eW(e){var t;return(t={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:e}}})[eu]=function(){return this},t}function eQ(e,t,r){var n=eW(t);if(n.deferred=!0,eh(e)){var i=n.state=eJ(void 0,function(){return(r?e.withContext(r):e).initialState});n.getSnapshot=function(){return i}}return n}function eX(e){return k(k({type:M},e),{toJSON:function(){e.onDone,e.onError;var t=b(e,["onDone","onError"]);return k(k({},t),{type:M,src:function(e){if("string"==typeof e){var t={type:e};return t.toString=function(){return e},t}return e}(e.src)})}})}var eZ={},e0=function(e){return"#"===e[0]},e1=function(){function e(t,r,n,i){void 0===n&&(n="context"in t?t.context:void 0);var s,o=this;this.config=t,this._context=n,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign({actions:{},guards:{},services:{},activities:{},delays:{}},r),this.parent=null==i?void 0:i.parent,this.key=this.config.key||(null==i?void 0:i.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:"."),this.id=this.config.id||A([this.machine.key],I(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:null!==(s=this.config.schema)&&void 0!==s?s:{},this.description=this.config.description,this.initial=this.config.initial,this.states=this.config.states?W(this.config.states,function(t,r){var n,i=new e(t,{},void 0,{parent:o,key:r});return Object.assign(o.idMap,k(((n={})[i.id]=i,n),i.idMap)),i}):eZ;var a=0;!function e(t){var r,n;t.order=a++;try{for(var i=x(eS(t)),s=i.next();!s.done;s=i.next()){var o=s.value;e(o)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}}(this),this.history=!0===this.config.history?"shallow":this.config.history||!1,this._transient=!!this.config.always||!!this.config.on&&(Array.isArray(this.config.on)?this.config.on.some(function(e){return""===e.event}):""in this.config.on),this.strict=!!this.config.strict,this.onEntry=et(this.config.entry||this.config.onEntry).map(function(e){return eN(e)}),this.onExit=et(this.config.exit||this.config.onExit).map(function(e){return eN(e)}),this.meta=this.config.meta,this.doneData="final"===this.type?this.config.data:void 0,this.invoke=et(this.config.invoke).map(function(e,t){if(eh(e)){var r,n,i=eg(o.id,t);return o.machine.options.services=k(((r={})[i]=e,r),o.machine.options.services),eX({src:i,id:i})}if(ec(e.src)){var i=e.id||eg(o.id,t);return eX(k(k({},e),{id:i,src:e.src}))}if(eh(e.src)||ea(e.src)){var i=e.id||eg(o.id,t);return o.machine.options.services=k(((n={})[i]=e.src,n),o.machine.options.services),eX(k(k({id:i},e),{src:i}))}var s=e.src;return eX(k(k({id:eg(o.id,t)},e),{src:s}))}),this.activities=et(this.config.activities).concat(this.invoke).map(function(e){return eD(e)}),this.transition=this.transition.bind(this),this.tags=et(this.config.tags)}return e.prototype._init=function(){this.__cache.transitions||(function e(t){var r=[t];return eE(t)?r:r.concat(ee(ew(t).map(e)))})(this).forEach(function(e){return e.on})},e.prototype.withConfig=function(t,r){var n=this.options,i=n.actions,s=n.activities,o=n.guards,a=n.services,c=n.delays;return new e(this.config,{actions:k(k({},i),t.actions),activities:k(k({},s),t.activities),guards:k(k({},o),t.guards),services:k(k({},a),t.services),delays:k(k({},c),t.delays)},null!=r?r:this.context)},e.prototype.withContext=function(t){return new e(this.config,this.options,t)},Object.defineProperty(e.prototype,"context",{get:function(){return ea(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:W(this.states,function(e){return e.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return this.definition},Object.defineProperty(e.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce(function(e,t){return e[t.eventType]=e[t.eventType]||[],e[t.eventType].push(t),e},{})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),e.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var t=""===e,r=this.transitions.filter(function(r){var n=r.eventType===e;return t?n:n||"*"===r.eventType});return this.__cache.candidates[e]=r,r},e.prototype.getDelayedTransitions=function(){var e=this,t=this.config.after;if(!t)return[];var r=function(t,r){var n=eV(ea(t)?"".concat(e.id,":delay[").concat(r,"]"):t,e.id);return e.onEntry.push(eP(n,{delay:t})),e.onExit.push(eL(n)),n};return(eo(t)?t.map(function(e,t){var n=r(e.delay,t);return k(k({},e),{event:n})}):ee(Object.keys(t).map(function(e,n){var i=t[e],s=ec(i)?{target:i}:i,o=isNaN(+e)?e:+e,a=r(o,n);return et(s).map(function(e){return k(k({},e),{event:a,delay:o})})}))).map(function(t){var r=t.delay;return k(k({},e.formatTransition(t)),{delay:r})})},e.prototype.getStateNodes=function(e){var t,r=this;if(!e)return[];var n=e instanceof eY?e.value:z(e,this.delimiter);if(ec(n)){var i=this.getStateNode(n).initial;return void 0!==i?this.getStateNodes(((t={})[n]=i,t)):[this,this.states[n]]}var s=Object.keys(n),o=[this];return o.push.apply(o,A([],I(ee(s.map(function(e){return r.getStateNode(e).getStateNodes(n[e])}))),!1)),o},e.prototype.handles=function(e){var t=H(e);return this.events.includes(t)},e.prototype.resolveState=function(e){var t=e instanceof eY?e:eY.create(e),r=Array.from(ek([],this.getStateNodes(t.value)));return new eY(k(k({},t),{value:this.resolve(t.value),configuration:r,done:eI(r,this),tags:eA(r),machine:this.machine}))},e.prototype.transitionLeafNode=function(e,t,r){var n=this.getStateNode(e).next(t,r);return n&&n.transitions.length?n:this.next(t,r)},e.prototype.transitionCompoundNode=function(e,t,r){var n=Object.keys(e),i=this.getStateNode(n[0])._transition(e[n[0]],t,r);return i&&i.transitions.length?i:this.next(t,r)},e.prototype.transitionParallelNode=function(e,t,r){var n,i,s={};try{for(var o=x(Object.keys(e)),a=o.next();!a.done;a=o.next()){var c=a.value,l=e[c];if(l){var u=this.getStateNode(c)._transition(l,t,r);u&&(s[c]=u)}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}var h=Object.keys(s).map(function(e){return s[e]}),d=ee(h.map(function(e){return e.transitions}));if(!h.some(function(e){return e.transitions.length>0}))return this.next(t,r);var p=ee(Object.keys(s).map(function(e){return s[e].configuration}));return{transitions:d,exitSet:ee(h.map(function(e){return e.exitSet})),configuration:p,source:t,actions:ee(Object.keys(s).map(function(e){return s[e].actions}))}},e.prototype._transition=function(e,t,r){return ec(e)?this.transitionLeafNode(e,t,r):1===Object.keys(e).length?this.transitionCompoundNode(e,t,r):this.transitionParallelNode(e,t,r)},e.prototype.getTransitionData=function(e,t){return this._transition(e.value,e,ep(t))},e.prototype.next=function(e,t){var r,n,i,s=this,o=t.name,a=[],c=[];try{for(var l=x(this.getCandidates(o)),u=l.next();!u.done;u=l.next()){var h=u.value,d=h.cond,p=h.in,f=e.context,v=!p||(ec(p)&&e0(p)?e.matches(z(this.getStateNodeById(p).path,this.delimiter)):G(z(p,this.delimiter),X(this.path.slice(0,-2))(e.value))),y=!1;try{y=!d||ev(this.machine,d,f,t,e)}catch(e){throw Error("Unable to evaluate guard '".concat(d.name||d.type,"' in transition for event '").concat(o,"' in state node '").concat(this.id,"':\n").concat(e.message))}if(y&&v){void 0!==h.target&&(c=h.target),a.push.apply(a,A([],I(h.actions),!1)),i=h;break}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}if(i){if(!c.length)return{transitions:[i],exitSet:[],configuration:e.value?[this]:[],source:e,actions:a};var m=ee(c.map(function(t){return s.getRelativeStateNodes(t,e.historyValue)})),g=!!i.internal;return{transitions:[i],exitSet:g?[]:ee(c.map(function(e){return s.getPotentiallyReenteringNodes(e)})),configuration:m,source:e,actions:a}}},e.prototype.getPotentiallyReenteringNodes=function(e){if(this.order<e.order)return[this];for(var t=[],r=this;r&&r!==e;)t.push(r),r=r.parent;return r!==e?[]:(t.push(e),t)},e.prototype.getActions=function(e,t,r,n,i,s,o){var a,c,l,u,h=this,d=s?ek([],this.getStateNodes(s.value)):[],p=new Set;try{for(var f=x(Array.from(e).sort(function(e,t){return e.order-t.order})),v=f.next();!v.done;v=f.next()){var y=v.value;(!ex(d,y)||ex(r.exitSet,y)||y.parent&&p.has(y.parent))&&p.add(y)}}catch(e){a={error:e}}finally{try{v&&!v.done&&(c=f.return)&&c.call(f)}finally{if(a)throw a.error}}try{for(var m=x(d),g=m.next();!g.done;g=m.next()){var y=g.value;(!ex(e,y)||ex(r.exitSet,y.parent))&&r.exitSet.push(y)}}catch(e){l={error:e}}finally{try{g&&!g.done&&(u=m.return)&&u.call(m)}finally{if(l)throw l.error}}r.exitSet.sort(function(e,t){return t.order-e.order});var T=Array.from(p).sort(function(e,t){return e.order-t.order}),E=new Set(r.exitSet),S=ee(T.map(function(e){var t=[];if("final"!==e.type)return t;var s=e.parent;if(!s.parent)return t;t.push(eB(e.id,e.doneData),eB(s.id,e.doneData?er(e.doneData,n,i):void 0));var o=s.parent;return"parallel"===o.type&&ew(o).every(function(e){return eI(r.configuration,e)})&&t.push(eB(o.id)),t})),w=T.map(function(e){var t=e.onEntry,r=e.activities.map(function(e){return eM(e)});return{type:"entry",actions:eR(o?A(A([],I(t),!1),I(r),!1):A(A([],I(r),!1),I(t),!1),h.machine.options.actions)}}).concat({type:"state_done",actions:S.map(function(e){return eC(e)})}),k=Array.from(E).map(function(e){return{type:"exit",actions:eR(A(A([],I(e.onExit),!1),I(e.activities.map(function(e){return ej(e)})),!1),h.machine.options.actions)}}).concat({type:"transition",actions:eR(r.actions,this.machine.options.actions)}).concat(w);if(t){var b=eR(ee(A([],I(e),!1).sort(function(e,t){return t.order-e.order}).map(function(e){return e.onExit})),this.machine.options.actions).filter(function(e){return!eT(e)});return k.concat({type:"stop",actions:b})}return k},e.prototype.transition=function(e,t,r,n){void 0===e&&(e=this.initialState);var i,s,o=ep(t);if(e instanceof eY)s=void 0===r?e:this.resolveState(eY.from(e,r));else{var a=ec(e)?this.resolve(J(this.getResolvedPath(e))):this.resolve(e),c=null!=r?r:this.machine.context;s=this.resolveState(eY.from(a,c))}if(this.strict&&!this.events.includes(o.name)&&(i=o.name,!/^(done|error)\./.test(i)))throw Error("Machine '".concat(this.id,"' does not accept event '").concat(o.name,"'"));var l=this._transition(s.value,s,o)||{transitions:[],configuration:[],exitSet:[],source:s,actions:[]},u=ek([],this.getStateNodes(s.value)),h=l.configuration.length?ek(u,l.configuration):u;return l.configuration=A([],I(h),!1),this.resolveTransition(l,s,s.context,n,o)},e.prototype.resolveRaisedTransition=function(e,t,r,n){var i,s=e.actions;return(e=this.transition(e,t,void 0,n))._event=r,e.event=r.data,(i=e.actions).unshift.apply(i,A([],I(s),!1)),e},e.prototype.resolveTransition=function(e,t,r,n,i){var s,o,a,c,l,u,h=this;void 0===i&&(i=e_);var d=e.configuration,p=!t||e.transitions.length>0,f=p?e.configuration:t?t.configuration:[],v=eI(f,this),y=p?(o=ek([s=this.machine],d),function e(t,r){var n=r.get(t);if(!n)return{};if("compound"===t.type){var i=n[0];if(!i)return{};if(eE(i))return i.key}var s={};return n.forEach(function(t){s[t.key]=e(t,r)}),s}(s,eb(o))):void 0,m=t?t.historyValue?t.historyValue:e.source?this.machine.historyValue(t.value):void 0:void 0,g=this.getActions(new Set(f),v,e,r,i,t,n),T=t?k({},t.activities):{};try{for(var E=x(g),S=E.next();!S.done;S=E.next()){var w=S.value;try{for(var b=(l=void 0,x(w.actions)),A=b.next();!A.done;A=b.next()){var N=A.value;N.type===_?T[N.activity.id||N.activity.type]=N:N.type===O&&(T[N.activity.id||N.activity.type]=!1)}}catch(e){l={error:e}}finally{try{A&&!A.done&&(u=b.return)&&u.call(b)}finally{if(l)throw l.error}}}}catch(e){a={error:e}}finally{try{S&&!S.done&&(c=E.return)&&c.call(E)}finally{if(a)throw a.error}}var R=I(eH(this,t,r,i,g,n,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),D=R[0],P=R[1],U=I(function(e,t){var r,n,i=I([[],[]],2),s=i[0],o=i[1];try{for(var a=x(e),c=a.next();!c.done;c=a.next()){var l=c.value;t(l)?s.push(l):o.push(l)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return[s,o]}(D,eT),2),L=U[0],j=U[1],F=D.filter(function(e){var t;return e.type===_&&(null===(t=e.activity)||void 0===t?void 0:t.type)===M}).reduce(function(e,t){var r,n,s,o,a,c,l,u;return e[t.activity.id]=(r=t.activity,n=h.machine,s=i,a=ey(r.src),c=null===(o=null==n?void 0:n.options.services)||void 0===o?void 0:o[a.type],l=r.data?er(r.data,P,s):void 0,(u=c?eQ(c,r.id,l):eW(r.id)).meta=r,u),e},t?k({},t.children):{}),B=new eY({value:y||t.value,context:P,_event:i,_sessionid:t?t._sessionid:null,historyValue:y?m?{current:y,states:function e(t,r){return W(t.states,function(t,n){if(t){var i=(ec(r)?void 0:r[n])||(t?t.current:void 0);if(i)return{current:i,states:e(t,i)}}})}(m,y)}:void 0:t?t.historyValue:void 0,history:!y||e.source?t:void 0,actions:y?j:[],activities:y?T:t?t.activities:{},events:[],configuration:f,transitions:e.transitions,children:F,done:v,tags:eA(f),machine:this}),$=r!==P;B.changed=i.name===V||$;var K=B.history;K&&delete K.history;var q=!v&&(this._transient||d.some(function(e){return e._transient}));if(!p&&(!q||""===i.name))return B;var G=B;if(!v)for(q&&(G=this.resolveRaisedTransition(G,{type:C},i,n));L.length;){var H=L.shift();G=this.resolveRaisedTransition(G,H._event,i,n)}var Y=G.changed||(K?!!G.actions.length||$||typeof K.value!=typeof G.value||!function e(t,r){if(t===r)return!0;if(void 0===t||void 0===r)return!1;if(ec(t)||ec(r))return t===r;var n=Object.keys(t),i=Object.keys(r);return n.length===i.length&&n.every(function(n){return e(t[n],r[n])})}(G.value,K.value):void 0);return G.changed=Y,G.history=K,G},e.prototype.getStateNode=function(e){if(e0(e))return this.machine.getStateNodeById(e);if(!this.states)throw Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var t=this.states[e];if(!t)throw Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return t},e.prototype.getStateNodeById=function(e){var t=e0(e)?e.slice(1):e;if(t===this.id)return this;var r=this.machine.idMap[t];if(!r)throw Error("Child state node '#".concat(t,"' does not exist on machine '").concat(this.id,"'"));return r},e.prototype.getStateNodeByPath=function(e){if("string"==typeof e&&e0(e))try{return this.getStateNodeById(e.slice(1))}catch(e){}for(var t=Y(e,this.delimiter).slice(),r=this;t.length;){var n=t.shift();if(!n.length)break;r=r.getStateNode(n)}return r},e.prototype.resolve=function(e){var t,r=this;if(!e)return this.initialStateValue||eZ;switch(this.type){case"parallel":return W(this.initialStateValue,function(t,n){return t?r.getStateNode(n).resolve(e[n]||t):eZ});case"compound":if(ec(e)){var n=this.getStateNode(e);if("parallel"===n.type||"compound"===n.type)return(t={})[e]=n.initialStateValue,t;return e}if(!Object.keys(e).length)return this.initialStateValue||{};return W(e,function(e,t){return e?r.getStateNode(t).resolve(e):eZ});default:return e||eZ}},e.prototype.getResolvedPath=function(e){if(e0(e)){var t=this.machine.idMap[e.slice(1)];if(!t)throw Error("Unable to find state node '".concat(e,"'"));return t.path}return Y(e,this.delimiter)},Object.defineProperty(e.prototype,"initialStateValue",{get:function(){var e,t;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;if("parallel"===this.type)t=Q(this.states,function(e){return e.initialStateValue||eZ},function(e){return"history"!==e.type});else if(void 0!==this.initial){if(!this.states[this.initial])throw Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));t=eE(this.states[this.initial])?this.initial:((e={})[this.initial]=this.states[this.initial].initialStateValue,e)}else t={};return this.__cache.initialStateValue=t,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),e.prototype.getInitialState=function(e,t){this._init();var r=this.getStateNodes(e);return this.resolveTransition({configuration:r,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,null!=t?t:this.machine.context,void 0)},Object.defineProperty(e.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){var e;if("history"===this.type){var t=this.config;e=ec(t.target)&&e0(t.target)?J(this.machine.getStateNodeById(t.target).path.slice(this.path.length-1)):t.target}return e},enumerable:!1,configurable:!0}),e.prototype.getRelativeStateNodes=function(e,t,r){return void 0===r&&(r=!0),r?"history"===e.type?e.resolveHistory(t):e.initialStateNodes:[e]},Object.defineProperty(e.prototype,"initialStateNodes",{get:function(){var e=this;return eE(this)?[this]:"compound"!==this.type||this.initial?ee(Z(this.initialStateValue).map(function(t){return e.getFromRelativePath(t)})):[this]},enumerable:!1,configurable:!0}),e.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var t=I(e),r=t[0],n=t.slice(1);if(!this.states)throw Error("Cannot retrieve subPath '".concat(r,"' from node with no states"));var i=this.getStateNode(r);if("history"===i.type)return i.resolveHistory();if(!this.states[r])throw Error("Child state '".concat(r,"' does not exist on '").concat(this.id,"'"));return this.states[r].getFromRelativePath(n)},e.prototype.historyValue=function(e){if(Object.keys(this.states).length)return{current:e||this.initialStateValue,states:Q(this.states,function(t,r){if(!e)return t.historyValue();var n=ec(e)?void 0:e[r];return t.historyValue(n||t.initialStateValue)},function(e){return!e.history})}},e.prototype.resolveHistory=function(e){var t,r=this;if("history"!==this.type)return[this];var n=this.parent;if(!e){var i=this.target;return i?ee(Z(i).map(function(e){return n.getFromRelativePath(e)})):n.initialStateNodes}var s=(t=n.path,function(e){var r,n,i=e;try{for(var s=x(t),o=s.next();!o.done;o=s.next()){var a=o.value;i=i.states[a]}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i})(e).current;return ec(s)?[n.getStateNode(s)]:ee(Z(s).map(function(e){return"deep"===r.history?n.getFromRelativePath(e):[n.states[e[0]]]}))},Object.defineProperty(e.prototype,"stateIds",{get:function(){var e=this,t=ee(Object.keys(this.states).map(function(t){return e.states[t].stateIds}));return[this.id].concat(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){if(this.__cache.events)return this.__cache.events;var e,t,r,n,i=this.states,s=new Set(this.ownEvents);if(i)try{for(var o=x(Object.keys(i)),a=o.next();!a.done;a=o.next()){var c=i[a.value];if(c.states)try{for(var l=(r=void 0,x(c.events)),u=l.next();!u.done;u=l.next()){var h=u.value;s.add("".concat(h))}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(s)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ownEvents",{get:function(){return Array.from(new Set(this.transitions.filter(function(e){return!(!e.target&&!e.actions.length&&e.internal)}).map(function(e){return e.eventType})))},enumerable:!1,configurable:!0}),e.prototype.resolveTarget=function(e){var t=this;if(void 0!==e)return e.map(function(e){if(!ec(e))return e;var r=e[0]===t.delimiter;if(r&&!t.parent)return t.getStateNodeByPath(e.slice(1));var n=r?t.key+e:e;if(!t.parent)return t.getStateNodeByPath(n);try{return t.parent.getStateNodeByPath(n)}catch(e){throw Error("Invalid transition definition for state node '".concat(t.id,"':\n").concat(e.message))}})},e.prototype.formatTransition=function(e){var t=this,r=function(e){if(void 0!==e&&""!==e)return et(e)}(e.target),n="internal"in e?e.internal:!r||r.some(function(e){return ec(e)&&e[0]===t.delimiter}),i=this.machine.options.guards,s=this.resolveTarget(r),o=k(k({},e),{actions:eR(et(e.actions)),cond:el(e.cond,i),target:s,source:this,internal:n,eventType:e.event,toJSON:function(){return k(k({},o),{target:o.target?o.target.map(function(e){return"#".concat(e.id)}):void 0,source:"#".concat(t.id)})}});return o},e.prototype.formatTransitions=function(){var e,t,r,n=this;if(this.config.on){if(Array.isArray(this.config.on))r=this.config.on;else{var i=this.config.on,s=i["*"],o=b(i,["*"]);r=ee(Object.keys(o).map(function(e){return ef(e,o[e])}).concat(ef("*",void 0===s?[]:s)))}}else r=[];var a=this.config.always?ef("",this.config.always):[],c=this.config.onDone?ef(String(eB(this.id)),this.config.onDone):[],l=ee(this.invoke.map(function(e){var t=[];return e.onDone&&t.push.apply(t,A([],I(ef(String(e$(e.id)),e.onDone)),!1)),e.onError&&t.push.apply(t,A([],I(ef(String(eK(e.id)),e.onError)),!1)),t})),u=this.after,h=ee(A(A(A(A([],I(c),!1),I(l),!1),I(r),!1),I(a),!1).map(function(e){return et(e).map(function(e){return n.formatTransition(e)})}));try{for(var d=x(u),p=d.next();!p.done;p=d.next()){var f=p.value;h.push(f)}}catch(t){e={error:t}}finally{try{p&&!p.done&&(t=d.return)&&t.call(d)}finally{if(e)throw e.error}}return h},e}();function e2(e,t){return new e1(e,t)}var e3=eP,e4={deferEvents:!1},e9=function(){function e(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=k(k({},e4),e)}return e.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents){this.schedule(e);return}this.process(e)}this.flushEvents()},e.prototype.schedule=function(e){if(!this.initialized||this.processingEvent){this.queue.push(e);return}if(0!==this.queue.length)throw Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()},e.prototype.clear=function(){this.queue=[]},e.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},e.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(e){throw this.clear(),e}finally{this.processingEvent=!1}},e}(),e5=new Map,e8=0,e6={bookId:function(){return"x:".concat(e8++)},register:function(e,t){return e5.set(e,t),e},get:function(e){return e5.get(e)},free:function(e){e5.delete(e)}};function e7(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r.g?r.g:void 0}var te={sync:!1,autoForward:!1};(a=v||(v={}))[a.NotStarted=0]="NotStarted",a[a.Running=1]="Running",a[a.Stopped=2]="Stopped";var tt=function(){function e(t,r){void 0===r&&(r=e.defaultOptions);var n=this;this.machine=t,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=v.NotStarted,this.children=new Map,this.forwardTo=new Set,this._outgoingQueue=[],this.init=this.start,this.send=function(e,t){if(eo(e))return n.batch(e),n.state;var r=ep(ed(e,t));if(n.status===v.Stopped)return n.state;if(n.status!==v.Running&&!n.options.deferEvents)throw Error('Event "'.concat(r.name,'" was sent to uninitialized service "').concat(n.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\nEvent: ').concat(JSON.stringify(r.data)));return n.scheduler.schedule(function(){n.forward(r);var e=n._nextState(r);n.update(e,r)}),n._state},this.sendTo=function(e,t,r){var i=n.parent&&(t===p.Parent||n.parent.id===t),s=i?n.parent:ec(t)?t===p.Internal?n:n.children.get(t)||e6.get(t):t&&"function"==typeof t.send?t:void 0;if(!s){if(!i)throw Error("Unable to send event to child '".concat(t,"' from service '").concat(n.id,"'."));return}if("machine"in s){if(n.status!==v.Stopped||n.parent!==s||n.state.done){var o=k(k({},e),{name:e.name===F?"".concat(eK(n.id)):e.name,origin:n.sessionId});!r&&n.machine.config.predictableActionArguments?n._outgoingQueue.push([s,o]):s.send(o)}}else!r&&n.machine.config.predictableActionArguments?n._outgoingQueue.push([s,e.data]):s.send(e.data)},this._exec=function(e,t,r,i){void 0===i&&(i=n.machine.options.actions);var s=e.exec||eO(e.type,i),o=ea(s)?s:s?s.exec:e.exec;if(o)try{return o(t,r.data,n.machine.config.predictableActionArguments?{action:e,_event:r}:{action:e,state:n.state,_event:r})}catch(e){throw n.parent&&n.parent.send({type:"xstate.error",data:e}),e}switch(e.type){case N:n.defer(e);break;case R:if("number"==typeof e.delay){n.defer(e);return}e.to?n.sendTo(e._event,e.to,r===e_):n.send(e._event);break;case D:n.cancel(e.sendId);break;case _:if(n.status!==v.Running)return;var a=e.activity;if(!n.machine.config.predictableActionArguments&&!n.state.activities[a.id||a.type])break;if(a.type===d.Invoke){var c=ey(a.src),l=n.machine.options.services?n.machine.options.services[c.type]:void 0,u=a.id,h=a.data,p="autoForward"in a?a.autoForward:!!a.forward;if(!l)return;var f=h?er(h,t,r):void 0;if("string"==typeof l)return;var y=ea(l)?l(t,r.data,{data:f,src:c,meta:a.meta}):l;if(!y)return;var m=void 0;eh(y)&&(y=f?y.withContext(f):y,m={autoForward:p}),n.spawn(y,u,m)}else n.spawnActivity(a);break;case O:n.stopChild(e.activity.id);break;case U:var g=e.label,T=e.value;g?n.logger(g,T):n.logger(T)}};var i=k(k({},e.defaultOptions),r),s=i.clock,o=i.logger,a=i.parent,c=i.id,l=void 0!==c?c:t.id;this.id=l,this.logger=o,this.clock=s,this.parent=a,this.options=i,this.scheduler=new e9({deferEvents:this.options.deferEvents}),this.sessionId=e6.bookId()}return Object.defineProperty(e.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:eJ(this,function(){return e._initialState=e.machine.initialState,e._initialState})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.execute=function(e,t){var r,n;try{for(var i=x(e.actions),s=i.next();!s.done;s=i.next()){var o=s.value;this.exec(o,e,t)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},e.prototype.update=function(e,t){var r,n,i,s,o,a,c,l,u=this;if(e._sessionid=this.sessionId,this._state=e,(!this.machine.config.predictableActionArguments||t===e_)&&this.options.execute)this.execute(this.state);else for(var h=void 0;h=this._outgoingQueue.shift();)h[0].send(h[1]);if(this.children.forEach(function(e){u.state.children[e.id]=e}),this.devTools&&this.devTools.send(t.data,e),e.event)try{for(var d=x(this.eventListeners),p=d.next();!p.done;p=d.next()){var f=p.value;f(e.event)}}catch(e){r={error:e}}finally{try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}try{for(var v=x(this.listeners),y=v.next();!y.done;y=v.next()){var f=y.value;f(e,e.event)}}catch(e){i={error:e}}finally{try{y&&!y.done&&(s=v.return)&&s.call(v)}finally{if(i)throw i.error}}try{for(var m=x(this.contextListeners),g=m.next();!g.done;g=m.next())(0,g.value)(this.state.context,this.state.history?this.state.history.context:void 0)}catch(e){o={error:e}}finally{try{g&&!g.done&&(a=m.return)&&a.call(m)}finally{if(o)throw o.error}}if(this.state.done){var T=e.configuration.find(function(e){return"final"===e.type&&e.parent===u.machine}),E=T&&T.doneData?er(T.doneData,e.context,t):void 0;this._doneEvent=e$(this.id,E);try{for(var S=x(this.doneListeners),w=S.next();!w.done;w=S.next()){var f=w.value;f(this._doneEvent)}}catch(e){c={error:e}}finally{try{w&&!w.done&&(l=S.return)&&l.call(S)}finally{if(c)throw c.error}}this._stop(),this._stopChildren(),e6.free(this.sessionId)}},e.prototype.onTransition=function(e){return this.listeners.add(e),this.status===v.Running&&e(this.state,this.state.event),this},e.prototype.subscribe=function(e,t,r){var n=this,i=em(e,t,r);this.listeners.add(i.next),this.status!==v.NotStarted&&i.next(this.state);var s=function(){n.doneListeners.delete(s),n.stopListeners.delete(s),i.complete()};return this.status===v.Stopped?i.complete():(this.onDone(s),this.onStop(s)),{unsubscribe:function(){n.listeners.delete(i.next),n.doneListeners.delete(s),n.stopListeners.delete(s)}}},e.prototype.onEvent=function(e){return this.eventListeners.add(e),this},e.prototype.onSend=function(e){return this.sendListeners.add(e),this},e.prototype.onChange=function(e){return this.contextListeners.add(e),this},e.prototype.onStop=function(e){return this.stopListeners.add(e),this},e.prototype.onDone=function(e){return this.status===v.Stopped&&this._doneEvent?e(this._doneEvent):this.doneListeners.add(e),this},e.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},e.prototype.start=function(e){var t=this;if(this.status===v.Running)return this;this.machine._init(),e6.register(this.sessionId,this),this.initialized=!0,this.status=v.Running;var r=void 0===e?this.initialState:eJ(this,function(){return"object"==typeof e&&null!==e&&"value"in e&&"_event"in e?t.machine.resolveState(e):t.machine.resolveState(eY.from(e,t.machine.context))});return this.options.devTools&&this.attachDev(),this.scheduler.initialize(function(){t.update(r,e_)}),this},e.prototype._stopChildren=function(){this.children.forEach(function(e){ea(e.stop)&&e.stop()}),this.children.clear()},e.prototype._stop=function(){var e,t,r,n,i,s,o,a,c,l;try{for(var u=x(this.listeners),h=u.next();!h.done;h=u.next()){var d=h.value;this.listeners.delete(d)}}catch(t){e={error:t}}finally{try{h&&!h.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}try{for(var p=x(this.stopListeners),f=p.next();!f.done;f=p.next()){var d=f.value;d(),this.stopListeners.delete(d)}}catch(e){r={error:e}}finally{try{f&&!f.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}try{for(var y=x(this.contextListeners),m=y.next();!m.done;m=y.next()){var d=m.value;this.contextListeners.delete(d)}}catch(e){i={error:e}}finally{try{m&&!m.done&&(s=y.return)&&s.call(y)}finally{if(i)throw i.error}}try{for(var g=x(this.doneListeners),T=g.next();!T.done;T=g.next()){var d=T.value;this.doneListeners.delete(d)}}catch(e){o={error:e}}finally{try{T&&!T.done&&(a=g.return)&&a.call(g)}finally{if(o)throw o.error}}if(!this.initialized)return this;this.initialized=!1,this.status=v.Stopped,this._initialState=void 0;try{for(var E=x(Object.keys(this.delayedEventsMap)),S=E.next();!S.done;S=E.next()){var w=S.value;this.clock.clearTimeout(this.delayedEventsMap[w])}}catch(e){c={error:e}}finally{try{S&&!S.done&&(l=E.return)&&l.call(E)}finally{if(c)throw c.error}}this.scheduler.clear(),this.scheduler=new e9({deferEvents:this.options.deferEvents})},e.prototype.stop=function(){var e=this,t=this.scheduler;return this._stop(),t.schedule(function(){if(null===(t=e._state)||void 0===t||!t.done){var t,r=ep({type:"xstate.stop"}),n=eJ(e,function(){var t=ee(A([],I(e.state.configuration),!1).sort(function(e,t){return t.order-e.order}).map(function(t){return eR(t.onExit,e.machine.options.actions)})),n=I(eH(e.machine,e.state,e.state.context,r,[{type:"exit",actions:t}],e.machine.config.predictableActionArguments?e._exec:void 0,e.machine.config.predictableActionArguments||e.machine.config.preserveActionOrder),2),i=n[0],s=n[1],o=new eY({value:e.state.value,context:s,_event:r,_sessionid:e.sessionId,historyValue:void 0,history:e.state,actions:i.filter(function(e){return!eT(e)}),activities:{},events:[],configuration:[],transitions:[],children:{},done:e.state.done,tags:e.state.tags,machine:e.machine});return o.changed=!0,o});e.update(n,r),e._stopChildren(),e6.free(e.sessionId)}}),this},e.prototype.batch=function(e){var t=this;if(this.status===v.NotStarted&&this.options.deferEvents);else if(this.status!==v.Running)throw Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));if(e.length){var r=!!this.machine.config.predictableActionArguments&&this._exec;this.scheduler.schedule(function(){var n,i,s=t.state,o=!1,a=[];try{for(var c=x(e),l=c.next();!l.done;l=c.next()){var u=l.value;!function(e){var n=ep(e);t.forward(n),s=eJ(t,function(){return t.machine.transition(s,n,void 0,r||void 0)}),a.push.apply(a,A([],I(t.machine.config.predictableActionArguments?s.actions:s.actions.map(function(e){var t,r;return t=s,r=e.exec,k(k({},e),{exec:void 0!==r?function(){return r(t.context,t.event,{action:e,state:t,_event:t._event})}:void 0})})),!1)),o=o||!!s.changed}(u)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}s.changed=o,s.actions=a,t.update(s,ep(e[e.length-1]))})}},e.prototype.sender=function(e){return this.send.bind(this,e)},e.prototype._nextState=function(e,t){var r=this;void 0===t&&(t=!!this.machine.config.predictableActionArguments&&this._exec);var n=ep(e);if(0===n.name.indexOf(j)&&!this.state.nextEvents.some(function(e){return 0===e.indexOf(j)}))throw n.data.data;return eJ(this,function(){return r.machine.transition(r.state,n,void 0,t||void 0)})},e.prototype.nextState=function(e){return this._nextState(e,!1)},e.prototype.forward=function(e){var t,r;try{for(var n=x(this.forwardTo),i=n.next();!i.done;i=n.next()){var s=i.value,o=this.children.get(s);if(!o)throw Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(s,"'."));o.send(e)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.defer=function(e){var t=this,r=this.clock.setTimeout(function(){"to"in e&&e.to?t.sendTo(e._event,e.to,!0):t.send(e._event)},e.delay);e.id&&(this.delayedEventsMap[e.id]=r)},e.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},e.prototype.exec=function(e,t,r){void 0===r&&(r=this.machine.options.actions),this._exec(e,t.context,t._event,r)},e.prototype.removeChild=function(e){var t;this.children.delete(e),this.forwardTo.delete(e),null===(t=this.state)||void 0===t||delete t.children[e]},e.prototype.stopChild=function(e){var t=this.children.get(e);t&&(this.removeChild(e),ea(t.stop)&&t.stop())},e.prototype.spawn=function(e,t,r){if(this.status!==v.Running)return eQ(e,t);if(en(e))return this.spawnPromise(Promise.resolve(e),t);if(ea(e))return this.spawnCallback(e,t);if(function(e){try{return"function"==typeof e.send}catch(e){return!1}}(e)&&"id"in e)return this.spawnActor(e,t);if(function(e){try{return"subscribe"in e&&ea(e.subscribe)}catch(e){return!1}}(e))return this.spawnObservable(e,t);if(eh(e))return this.spawnMachine(e,k(k({},r),{id:t}));if(null!==e&&"object"==typeof e&&"transition"in e&&"function"==typeof e.transition)return this.spawnBehavior(e,t);throw Error('Unable to spawn entity "'.concat(t,'" of type "').concat(typeof e,'".'))},e.prototype.spawnMachine=function(t,r){var n=this;void 0===r&&(r={});var i=new e(t,k(k({},this.options),{parent:this,id:r.id||t.id})),s=k(k({},te),r);return s.sync&&i.onTransition(function(e){n.send(V,{state:e,id:i.id})}),this.children.set(i.id,i),s.autoForward&&this.forwardTo.add(i.id),i.onDone(function(e){n.removeChild(i.id),n.send(ep(e,{origin:i.id}))}).start(),i},e.prototype.spawnBehavior=function(e,t){var r,n,i,s,o,a,c,l,u,h,d=(r={id:t,parent:this},n=e.initialState,i=new Set,s=[],o=!1,a=function(){if(!o){for(o=!0;s.length>0;){var t=s.shift();n=e.transition(n,t,h),i.forEach(function(e){return e.next(n)})}o=!1}},c={id:r.id,send:function(e){s.push(e),a()},getSnapshot:function(){return n},subscribe:function(e,t,r){var s=em(e,t,r);return i.add(s),s.next(n),{unsubscribe:function(){i.delete(s)}}}},u=k(((l={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}})[eu]=function(){return this},l),c),h={parent:r.parent,self:u,id:r.id||"anonymous",observers:i},n=e.start?e.start(h):n,u);return this.children.set(t,d),d},e.prototype.spawnPromise=function(e,t){var r,n,i=this,s=!1;e.then(function(e){s||(n=e,i.removeChild(t),i.send(ep(e$(t,e),{origin:t})))},function(e){if(!s){i.removeChild(t);var r=eK(t,e);try{i.send(ep(r,{origin:t}))}catch(e){i.devTools&&i.devTools.send(r,i.state),i.machine.strict&&i.stop()}}});var o=((r={id:t,send:function(){},subscribe:function(t,r,n){var i=em(t,r,n),s=!1;return e.then(function(e){!s&&(i.next(e),s||i.complete())},function(e){s||i.error(e)}),{unsubscribe:function(){return s=!0}}},stop:function(){s=!0},toJSON:function(){return{id:t}},getSnapshot:function(){return n}})[eu]=function(){return this},r);return this.children.set(t,o),o},e.prototype.spawnCallback=function(e,t){var r,n,i,s=this,o=!1,a=new Set,c=new Set;try{i=e(function(e){n=e,c.forEach(function(t){return t(e)}),o||s.send(ep(e,{origin:t}))},function(e){a.add(e)})}catch(e){this.send(eK(t,e))}if(en(i))return this.spawnPromise(i,t);var l=((r={id:t,send:function(e){return a.forEach(function(t){return t(e)})},subscribe:function(e){var t=em(e);return c.add(t.next),{unsubscribe:function(){c.delete(t.next)}}},stop:function(){o=!0,ea(i)&&i()},toJSON:function(){return{id:t}},getSnapshot:function(){return n}})[eu]=function(){return this},r);return this.children.set(t,l),l},e.prototype.spawnObservable=function(e,t){var r,n,i=this,s=e.subscribe(function(e){n=e,i.send(ep(e,{origin:t}))},function(e){i.removeChild(t),i.send(ep(eK(t,e),{origin:t}))},function(){i.removeChild(t),i.send(ep(e$(t),{origin:t}))}),o=((r={id:t,send:function(){},subscribe:function(t,r,n){return e.subscribe(t,r,n)},stop:function(){return s.unsubscribe()},getSnapshot:function(){return n},toJSON:function(){return{id:t}}})[eu]=function(){return this},r);return this.children.set(t,o),o},e.prototype.spawnActor=function(e,t){return this.children.set(t,e),e},e.prototype.spawnActivity=function(e){var t=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(t){var r=t(this.state.context,e);this.spawnEffect(e.id,r)}},e.prototype.spawnEffect=function(e,t){var r;this.children.set(e,((r={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:t||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}})[eu]=function(){return this},r))},e.prototype.attachDev=function(){var e=e7();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var t="object"==typeof this.options.devTools?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(k(k({name:this.id,autoPause:!0,stateSanitizer:function(e){return{value:e.value,context:e.context,actions:e.actions}}},t),{features:k({jump:!1,skip:!1},t?t.features:void 0)}),this.machine),this.devTools.init(this.state)}!function(e){if(e7()){var t=function(){var e=e7();if(e&&"__xstate__"in e)return e.__xstate__}();t&&t.register(e)}}(this)}},e.prototype.toJSON=function(){return{id:this.id}},e.prototype[eu]=function(){return this},e.prototype.getSnapshot=function(){return this.status===v.NotStarted?this.initialState:this._state},e.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(e,t){return setTimeout(e,t)},clearTimeout:function(e){return clearTimeout(e)}},logger:console.log.bind(console),devTools:!1},e.interpret=tr,e}();function tr(e,t){return new tt(e,t)}function tn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}var ti=function e(t,r){function n(e,n,i){if("undefined"!=typeof document){"number"==typeof(i=tn({},r,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var o in i)i[o]&&(s+="; "+o,!0!==i[o]&&(s+="="+i[o].split(";")[0]));return document.cookie=e+"="+t.write(n,e)+s}}return Object.create({set:n,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],n={},i=0;i<r.length;i++){var s=r[i].split("="),o=s.slice(1).join("=");try{var a=decodeURIComponent(s[0]);if(n[a]=t.read(o,a),e===a)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){n(e,"",tn({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,tn({},this.attributes,t))},withConverter:function(t){return e(tn({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),ts=r(7559),to=r.n(ts);let ta="nhostRefreshToken",tc="nhostRefreshTokenId",tl="nhostRefreshTokenExpiresAt";class tu extends Error{constructor(e){super(e.message),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),e instanceof Error?(this.name=e.name,this.error={error:e.name,status:1,message:e.message}):(this.name=e.error,this.error=e)}}let th={status:10,error:"invalid-email",message:"Email is incorrectly formatted"},td={status:10,error:"invalid-password",message:"Password is incorrectly formatted"},tp={status:10,error:"invalid-phone-number",message:"Phone number is incorrectly formatted"},tf={status:10,error:"invalid-mfa-ticket",message:"MFA ticket is invalid"},tv={status:10,error:"no-mfa-ticket",message:"No MFA ticket has been provided"},ty={status:10,error:"no-refresh-token",message:"No refresh token has been provided"},tm={status:20,error:"refresher-already-running",message:"The token refresher is already running. You must wait until is has finished before submitting a new token."},tg={status:20,error:"already-signed-in",message:"User is already signed in"},tT={status:20,error:"unauthenticated-user",message:"User is not authenticated"},tE={status:20,error:"unverified-user",message:"Email needs verification"},tS={status:10,error:"invalid-refresh-token",message:"Invalid or expired refresh token"},tw={status:1,error:"invalid-sign-in-method",message:"Invalid sign-in method"},tk={user:null,mfa:null,accessToken:{value:null,expiresAt:null,expiresInSeconds:15},refreshTimer:{startedAt:null,attempts:0,lastAttempt:null},refreshToken:{value:null},importTokenAttempts:0,errors:{}};function tb(e){let t=new Uint8Array(e),r="";for(let e of t)r+=String.fromCharCode(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function tx(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=(4-t.length%4)%4,n=atob(t.padEnd(t.length+r,"=")),i=new ArrayBuffer(n.length),s=new Uint8Array(i);for(let e=0;e<n.length;e++)s[e]=n.charCodeAt(e);return i}function tI(){return(null==window?void 0:window.PublicKeyCredential)!==void 0&&"function"==typeof window.PublicKeyCredential}function tA(e){let{id:t}=e;return{...e,id:tx(t),transports:e.transports}}function t_(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}class tO extends Error{constructor({message:e,code:t,cause:r,name:n}){super(e,{cause:r}),this.name=null!=n?n:r.name,this.code=t}}class tN{createNewAbortSignal(){if(this.controller){let e=Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}let e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){let e=Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}let tR=new tN,tD=["cross-platform","platform"];function tC(e){if(e&&!(0>tD.indexOf(e)))return e}async function tP(e){var t,r;let n,i,s,o,a;if(!tI())throw Error("WebAuthn is not supported in this browser");let c={publicKey:{...e,challenge:tx(e.challenge),user:{...e.user,id:(r=e.user.id,new TextEncoder().encode(r))},excludeCredentials:null==(t=e.excludeCredentials)?void 0:t.map(tA)}};c.signal=tR.createNewAbortSignal();try{n=await navigator.credentials.create(c)}catch(e){throw function({error:e,options:t}){var r,n;let{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new tO({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if((null==(r=i.authenticatorSelection)?void 0:r.requireResidentKey)===!0)return new tO({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if((null==(n=i.authenticatorSelection)?void 0:n.userVerification)==="required")return new tO({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if("InvalidStateError"===e.name)return new tO({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if("NotAllowedError"===e.name)return new tO({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if("NotSupportedError"===e.name)return new tO(0===i.pubKeyCredParams.filter(e=>"public-key"===e.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if("SecurityError"===e.name){let t=window.location.hostname;if(!t_(t))return new tO({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(i.rp.id!==t)return new tO({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new tO({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new tO({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return e}({error:e,options:c})}if(!n)throw Error("Registration was not completed");let{id:l,rawId:u,response:h,type:d}=n;if("function"==typeof h.getTransports&&(i=h.getTransports()),"function"==typeof h.getPublicKeyAlgorithm)try{s=h.getPublicKeyAlgorithm()}catch(e){tU("getPublicKeyAlgorithm()",e)}if("function"==typeof h.getPublicKey)try{let e=h.getPublicKey();null!==e&&(o=tb(e))}catch(e){tU("getPublicKey()",e)}if("function"==typeof h.getAuthenticatorData)try{a=tb(h.getAuthenticatorData())}catch(e){tU("getAuthenticatorData()",e)}return{id:l,rawId:tb(u),response:{attestationObject:tb(h.attestationObject),clientDataJSON:tb(h.clientDataJSON),transports:i,publicKeyAlgorithm:s,publicKey:o,authenticatorData:a},type:d,clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:tC(n.authenticatorAttachment)}}function tU(e,t){console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${e}. You should report this error to them.
`,t)}async function tL(e,t=!1){var r,n,i;let s,o,a;if(!tI())throw Error("WebAuthn is not supported in this browser");(null==(r=e.allowCredentials)?void 0:r.length)!==0&&(s=null==(n=e.allowCredentials)?void 0:n.map(tA));let c={...e,challenge:tx(e.challenge),allowCredentials:s},l={};if(t){if(!await function(){let e=window.PublicKeyCredential;return void 0===e.isConditionalMediationAvailable?new Promise(e=>e(!1)):e.isConditionalMediationAvailable()}())throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete$='webauthn']").length<1)throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');l.mediation="conditional",c.allowCredentials=[]}l.publicKey=c,l.signal=tR.createNewAbortSignal();try{o=await navigator.credentials.get(l)}catch(e){throw function({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new tO({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if("NotAllowedError"===e.name)return new tO({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if("SecurityError"===e.name){let t=window.location.hostname;if(!t_(t))return new tO({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rpId!==t)return new tO({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new tO({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return e}({error:e,options:l})}if(!o)throw Error("Authentication was not completed");let{id:u,rawId:h,response:d,type:p}=o;return d.userHandle&&(i=d.userHandle,a=new TextDecoder("utf-8").decode(i)),{id:u,rawId:tb(h),response:{authenticatorData:tb(d.authenticatorData),clientDataJSON:tb(d.clientDataJSON),signature:tb(d.signature),userHandle:a},type:p,clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:tC(o.authenticatorAttachment)}}let tM="undefined"!=typeof window,tj=new Map,tF=e=>{var t;return tM&&"undefined"!=typeof localStorage?localStorage.getItem(e):null!=(t=tj.get(e))?t:null},tV=(e,t)=>{tM&&"undefined"!=typeof localStorage?t?localStorage.setItem(e,t):localStorage.removeItem(e):t?tj.set(e,t):tj.has(e)&&tj.delete(e)},tB=(e,t)=>{if("localStorage"===e||"web"===e)return tF;if("cookie"===e)return e=>{var t;return tM&&null!=(t=ti.get(e))?t:null};if(!t)throw Error(`clientStorageType is set to '${e}' but no clientStorage has been given`);if("react-native"===e)return e=>{var r;return null==(r=t.getItem)?void 0:r.call(t,e)};if("capacitor"===e)return e=>{var r;return null==(r=t.get)?void 0:r.call(t,{key:e})};if("expo-secure-storage"===e)return e=>{var r;return null==(r=t.getItemAsync)?void 0:r.call(t,e)};if("custom"===e){if(t.getItem&&t.removeItem)return t.getItem;if(t.getItemAsync)return t.getItemAsync;throw Error('clientStorageType is set to \'custom\' but clientStorage is missing either "getItem" and "removeItem" properties or "getItemAsync" property')}throw Error(`Unknown storage type: ${e}`)},t$=(e,t)=>{if("localStorage"===e||"web"===e)return tV;if("cookie"===e)return(e,t)=>{tM&&(t?ti.set(e,t,{expires:30,sameSite:"lax",httpOnly:!1}):ti.remove(e))};if(!t)throw Error(`clientStorageType is set to '${e}' but no clienStorage has been given`);if("react-native"===e)return(e,r)=>{var n,i;return r?null==(n=t.setItem)?void 0:n.call(t,e,r):null==(i=t.removeItem)?void 0:i.call(t,e)};if("capacitor"===e)return(e,r)=>{var n,i;return r?null==(n=t.set)?void 0:n.call(t,{key:e,value:r}):null==(i=t.remove)?void 0:i.call(t,{key:e})};if("expo-secure-storage"===e)return async(e,r)=>{var n,i;return r?null==(n=t.setItemAsync)?void 0:n.call(t,e,r):null==(i=t.deleteItemAsync)?void 0:i.call(t,e)};if("custom"===e){if(!t.removeItem)throw Error("clientStorageType is set to 'custom' but clientStorage is missing a removeItem property");if(t.setItem)return(e,r)=>{var n,i;return r?null==(n=t.setItem)?void 0:n.call(t,e,r):null==(i=t.removeItem)?void 0:i.call(t,e)};if(t.setItemAsync)return async(e,r)=>{var n,i;return r?null==(n=t.setItemAsync)?void 0:n.call(t,e,r):null==(i=t.removeItem)?void 0:i.call(t,e)};throw Error("clientStorageType is set to 'custom' but clientStorage is missing setItem or setItemAsync property")}throw Error(`Unknown storage type: ${e}`)},tK=e=>e&&e.accessToken.value&&e.accessToken.expiresAt&&e.user?{accessToken:e.accessToken.value,accessTokenExpiresIn:(e.accessToken.expiresAt.getTime()-Date.now())/1e3,refreshToken:e.refreshToken.value,user:e.user}:null,tq=({accessToken:e,refreshToken:t,isError:r,user:n,error:i})=>r?{session:null,error:i}:n&&e?{session:{accessToken:e,accessTokenExpiresIn:0,refreshToken:t,user:n},error:null}:{session:null,error:null},tG=()=>"undefined"!=typeof window&&void 0!==window.location,tH=globalThis.fetch;"string"!=typeof EdgeRuntime&&(tH=to()().fetch);let tY=async(e,t,{token:r,body:n,extraHeaders:i}={})=>{let s={"Content-Type":"application/json",Accept:"*/*"};r&&(s.Authorization=`Bearer ${r}`);let o={method:t,headers:{...s,...i}};n&&(o.body=JSON.stringify(n));try{let t=await tH(e,o);if(!t.ok){let e=await t.json();return Promise.reject({error:e})}try{return{data:await t.json(),error:null}}catch{return console.warn(`Unexpected response: can't parse the response of the server at ${e}`),{data:"OK",error:null}}}catch{return Promise.reject({error:{message:"Network Error",status:0,error:"network"}})}},tz=async(e,t,r,n)=>tY(e,"POST",{token:r,body:t,extraHeaders:n}),tJ=(e,t)=>{let r=t&&Object.entries(t).map(([e,t])=>{let r=Array.isArray(t)?t.join(","):"object"==typeof t?JSON.stringify(t):t;return`${e}=${encodeURIComponent(r)}`}).join("&");return r?`${e}?${r}`:e},tW=(e,t)=>{if(!(null!=t&&t.redirectTo))return t;let{redirectTo:r,...n}=t;if(!e)return r.startsWith("/")?n:t;let i=new URL(e),s=Object.fromEntries(new URLSearchParams(i.search)),o=new URL(r.startsWith("/")?i.origin+r:r),a=Object.fromEntries(new URLSearchParams(o.search));r.startsWith("/")&&(a={...s,...a});let c=i.pathname;return o.pathname.length>1&&(c+=o.pathname.slice(1)),{...n,redirectTo:tJ(o.origin+c,a)}};function tQ(e,t){var r;if(!t){if("undefined"==typeof window)return;t=(null==(r=window.location)?void 0:r.href)||""}let n=RegExp("[?&#]"+(e=e.replace(/[\[\]]/g,"\\$&"))+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function tX(e){var t;if("undefined"==typeof window)return;let r=null==window?void 0:window.location;if(r&&r){let n=new URLSearchParams(r.search),i=new URLSearchParams(null==(t=r.hash)?void 0:t.slice(1));n.delete(e),i.delete(e);let s=window.location.pathname;Array.from(n).length&&(s+=`?${n.toString()}`),Array.from(i).length&&(s+=`#${i.toString()}`),window.history.pushState({},"",s)}}let tZ=e=>!!e&&"string"==typeof e&&!!String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),t0=e=>!!e&&"string"==typeof e&&e.length>=3,t1=e=>!!e&&"string"==typeof e,t2=e=>e&&"string"==typeof e&&e.match(/^mfaTotp:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i),t3=({backendUrl:e,clientUrl:t,broadcastKey:r,clientStorageType:n="web",clientStorage:i,refreshIntervalTime:s,autoRefreshToken:o=!0,autoSignIn:a=!0})=>{let c=tB(n,i),l=t$(n,i),u=async(t,r,n,i)=>(await tz(`${e}${t}`,r,n,i)).data,h=null;if("undefined"!=typeof window&&r)try{h=new BroadcastChannel(r)}catch{}return e2({schema:{context:{},events:{},services:{}},tsTypes:{},context:tk,predictableActionArguments:!0,id:"nhost",type:"parallel",states:{authentication:{initial:"starting",on:{SESSION_UPDATE:[{cond:"hasSession",actions:["saveSession","resetTimer","reportTokenChanged"],target:".signedIn"}]},states:{starting:{tags:["loading"],always:{cond:"isSignedIn",target:"signedIn"},invoke:{id:"importRefreshToken",src:"importRefreshToken",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"signedIn"},{target:"signedOut"}],onError:[{cond:"shouldRetryImportToken",actions:"incrementTokenImportAttempts",target:"retryTokenImport"},{actions:["saveAuthenticationError"],target:"signedOut"}]}},retryTokenImport:{tags:["loading"],after:{RETRY_IMPORT_TOKEN_DELAY:"starting"}},signedOut:{initial:"noErrors",entry:"reportSignedOut",states:{noErrors:{},success:{},needsSmsOtp:{},needsMfa:{},failed:{},signingOut:{entry:["clearContextExceptTokens"],exit:["destroyAccessToken","destroyRefreshToken","reportTokenChanged"],invoke:{src:"signout",id:"signingOut",onDone:{target:"success"},onError:{target:"failed",actions:["saveAuthenticationError"]}}}},on:{SIGNIN_PASSWORD:"authenticating.password",SIGNIN_ANONYMOUS:"authenticating.anonymous",SIGNIN_SECURITY_KEY_EMAIL:"authenticating.securityKeyEmail",SIGNIN_SECURITY_KEY:"authenticating.securityKey",SIGNIN_MFA_TOTP:"authenticating.mfa.totp",SIGNIN_PAT:"authenticating.pat",SIGNIN_ID_TOKEN:"authenticating.idToken"}},authenticating:{entry:"resetErrors",states:{password:{invoke:{src:"signInPassword",id:"authenticateUserWithPassword",onDone:[{cond:"hasMfaTicket",actions:["saveMfaTicket"],target:"#nhost.authentication.signedOut.needsMfa"},{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"}],onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}},pat:{invoke:{src:"signInPAT",id:"authenticateWithPAT",onDone:{actions:["savePATSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},idToken:{invoke:{src:"signInIdToken",id:"authenticateWithIdToken",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},anonymous:{invoke:{src:"signInAnonymous",id:"authenticateAnonymously",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},mfa:{states:{totp:{invoke:{src:"signInMfaTotp",id:"signInMfaTotp",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:["saveAuthenticationError"],target:"#nhost.authentication.signedOut.failed"}}}}},securityKeyEmail:{invoke:{src:"signInSecurityKeyEmail",id:"authenticateUserWithSecurityKey",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}},securityKey:{invoke:{src:"signInSecurityKey",id:"authenticateUserWithSecurityKey",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}}}},signedIn:{type:"parallel",entry:["reportSignedIn","cleanUrl","broadcastToken","resetErrors"],on:{SIGNOUT:"signedOut.signingOut"},states:{refreshTimer:{id:"timer",initial:"idle",states:{disabled:{type:"final"},stopped:{always:{cond:"noToken",target:"idle"}},idle:{always:[{cond:"isAutoRefreshDisabled",target:"disabled"},{cond:"isRefreshTokenPAT",target:"disabled"},{cond:"hasRefreshToken",target:"running"}]},running:{initial:"pending",entry:"resetTimer",states:{pending:{after:{1e3:{internal:!1,target:"pending"}},always:{cond:"refreshTimerShouldRefresh",target:"refreshing"}},refreshing:{invoke:{src:"refreshToken",id:"refreshToken",onDone:{actions:["saveSession","resetTimer","reportTokenChanged","broadcastToken"],target:"pending"},onError:[{cond:"isUnauthorizedError",target:"#nhost.authentication.signedOut"},{actions:"saveRefreshAttempt",target:"pending"}]}}}}}}}}}},token:{initial:"idle",states:{idle:{on:{TRY_TOKEN:"running"},initial:"noErrors",states:{noErrors:{},error:{}}},running:{invoke:{src:"refreshToken",id:"authenticateWithToken",onDone:{actions:["saveSession","reportTokenChanged","broadcastToken"],target:["#nhost.authentication.signedIn","idle.noErrors"]},onError:[{cond:"isSignedIn",target:"idle.error"},{actions:"saveAuthenticationError",target:["#nhost.authentication.signedOut.failed","idle.error"]}]}}}},registration:{initial:"incomplete",on:{SIGNED_IN:[{cond:"isAnonymous",target:".incomplete"},".complete"]},states:{incomplete:{on:{SIGNUP_EMAIL_PASSWORD:"emailPassword",SIGNUP_SECURITY_KEY:"securityKey",PASSWORDLESS_EMAIL:"passwordlessEmail",PASSWORDLESS_SMS:"passwordlessSms",PASSWORDLESS_SMS_OTP:"passwordlessSmsOtp",SIGNIN_EMAIL_OTP:"signInEmailOTP",VERIFY_EMAIL_OTP:"verifyEmailOTP"},initial:"noErrors",states:{noErrors:{},needsEmailVerification:{},needsOtp:{},failed:{}}},emailPassword:{entry:["resetErrors"],invoke:{src:"signUpEmailPassword",id:"signUpEmailPassword",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]}],onError:[{cond:"unverified",target:"incomplete.needsEmailVerification"},{actions:"saveRegistrationError",target:"incomplete.failed"}]}},securityKey:{entry:["resetErrors"],invoke:{src:"signUpSecurityKey",id:"signUpSecurityKey",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]}],onError:[{cond:"unverified",target:"incomplete.needsEmailVerification"},{actions:"saveRegistrationError",target:"incomplete.failed"}]}},passwordlessEmail:{entry:["resetErrors"],invoke:{src:"passwordlessEmail",id:"passwordlessEmail",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},passwordlessSms:{entry:["resetErrors"],invoke:{src:"passwordlessSms",id:"passwordlessSms",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsOtp"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},passwordlessSmsOtp:{entry:["resetErrors"],invoke:{src:"passwordlessSmsOtp",id:"passwordlessSmsOtp",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},signInEmailOTP:{entry:["resetErrors"],invoke:{src:"signInEmailOTP",id:"signInEmailOTP",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsOtp"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},verifyEmailOTP:{entry:["resetErrors"],invoke:{src:"verifyEmailOTP",id:"verifyEmailOTP",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},complete:{on:{SIGNED_OUT:"incomplete"}}}}}},{actions:{reportSignedIn:e3("SIGNED_IN"),reportSignedOut:e3("SIGNED_OUT"),reportTokenChanged:e3("TOKEN_CHANGED"),incrementTokenImportAttempts:eF({importTokenAttempts:({importTokenAttempts:e})=>e+1}),clearContext:eF(()=>(l(tl,null),l(ta,null),l(tc,null),{...tk})),clearContextExceptTokens:eF(({accessToken:e,refreshToken:t})=>({...tk,accessToken:e,refreshToken:t})),saveSession:eF({user:(e,{data:t})=>{var r;return(null==(r=null==t?void 0:t.session)?void 0:r.user)||null},accessToken:(e,{data:t})=>{if(t.session){let{accessTokenExpiresIn:e,accessToken:r}=t.session,n=new Date(Date.now()+1e3*e);return l(tl,n.toISOString()),{value:r,expiresAt:n,expiresInSeconds:e}}return l(tl,null),{value:null,expiresAt:null,expiresInSeconds:null}},refreshToken:(e,{data:t})=>{var r,n;let i=(null==(r=t.session)?void 0:r.refreshToken)||null,s=(null==(n=t.session)?void 0:n.refreshTokenId)||null;return i&&l(ta,i),s&&l(tc,s),{value:i}}}),savePATSession:eF({user:(e,{data:t})=>{var r;return(null==(r=null==t?void 0:t.session)?void 0:r.user)||null},accessToken:(e,{data:t})=>{if(t.session){let{accessTokenExpiresIn:e,accessToken:r}=t.session,n=new Date(Date.now()+1e3*e);return l(tl,n.toISOString()),{value:r,expiresAt:n,expiresInSeconds:e}}return l(tl,null),{value:null,expiresAt:null,expiresInSeconds:null}},refreshToken:(e,{data:t})=>{var r,n;let i=(null==(r=t.session)?void 0:r.refreshToken)||null,s=(null==(n=t.session)?void 0:n.refreshTokenId)||null;return i&&l(ta,i),s&&l(tc,s),{value:i,isPAT:!0}}}),saveMfaTicket:eF({mfa:(e,t)=>{var r;return null==(r=t.data)?void 0:r.mfa}}),resetTimer:eF({refreshTimer:e=>({startedAt:new Date,attempts:0,lastAttempt:null})}),saveRefreshAttempt:eF({refreshTimer:(e,t)=>({startedAt:e.refreshTimer.startedAt,attempts:e.refreshTimer.attempts+1,lastAttempt:new Date})}),saveAuthenticationError:eF({errors:({errors:e},{data:{error:t}})=>({...e,authentication:t})}),resetErrors:eF({errors:e=>({}),importTokenAttempts:e=>0}),saveRegistrationError:eF({errors:({errors:e},{data:{error:t}})=>({...e,registration:t})}),destroyRefreshToken:eF({refreshToken:e=>(l(ta,null),l(tc,null),{value:null})}),destroyAccessToken:eF({accessToken:e=>(l(tl,null),{value:null,expiresAt:null,expiresInSeconds:null})}),cleanUrl:()=>{a&&tQ("refreshToken")&&(tX("refreshToken"),tX("type"))},broadcastToken:e=>{if(a&&r&&h)try{h.postMessage({type:"broadcast_session",payload:{token:e.refreshToken.value,accessToken:e.accessToken.value,user:e.user,expiresAt:e.accessToken.expiresAt?e.accessToken.expiresAt.toISOString():null,expiresInSeconds:e.accessToken.expiresInSeconds}})}catch{}}},guards:{isAnonymous:(e,t)=>{var r;return!!(null!=(r=e.user)&&r.isAnonymous)},isSignedIn:e=>!!e.user&&!!e.accessToken.value,noToken:e=>!e.refreshToken.value,isRefreshTokenPAT:e=>{var t;return!!(null!=(t=e.refreshToken)&&t.isPAT)},hasRefreshToken:e=>!!e.refreshToken.value,isAutoRefreshDisabled:()=>!o,refreshTimerShouldRefresh:e=>{let{expiresAt:t}=e.accessToken;if(!t)return!1;if(e.refreshTimer.lastAttempt)return!(e.refreshTimer.attempts>5)&&Date.now()-e.refreshTimer.lastAttempt.getTime()>5e3*Math.pow(2,e.refreshTimer.attempts-1);if(t.getTime()<Date.now()||s&&Date.now()-e.refreshTimer.startedAt.getTime()>1e3*s)return!0;if(!e.accessToken.expiresInSeconds)return!1;let r=t.getTime()-Date.now();return r<=3e4||r<=6e4&&.1>Math.random()},shouldRetryImportToken:(e,t)=>e.importTokenAttempts<5&&(0===t.data.error.status||t.data.error.status>=500),unverified:(e,{data:{error:t}})=>401===t.status&&("Email is not verified"===t.message||"unverified-user"===t.error),hasSession:(e,t)=>{var r;return!!(null!=(r=t.data)&&r.session)},hasMfaTicket:(e,t)=>{var r;return!!(null!=(r=t.data)&&r.mfa)},isUnauthorizedError:(e,{data:{error:t}})=>401===t.status},services:{signInPassword:(e,{email:t,password:r})=>tZ(t)?t0(r)?u("/signin/email-password",{email:t,password:r}):Promise.reject({error:td}):Promise.reject({error:th}),signInPAT:(e,{pat:t})=>u("/signin/pat",{personalAccessToken:t}),signInIdToken:(e,{provider:t,idToken:r,nonce:n})=>u("/signin/idtoken",{provider:t,idToken:r,...n&&{nonce:n}}),passwordlessSms:(e,{phoneNumber:r,options:n})=>{var i;return t1(r)?null!=(i=e.user)&&i.isAnonymous?(console.warn("Deanonymisation from a phone number is not yet implemented in hasura-auth"),u("/user/deanonymize",{signInMethod:"passwordless",connection:"sms",phoneNumber:r,options:tW(t,n)},e.accessToken.value)):u("/signin/passwordless/sms",{phoneNumber:r,options:tW(t,n)}):Promise.reject({error:tp})},passwordlessSmsOtp:(e,{phoneNumber:t,otp:r})=>t1(t)?u("/signin/passwordless/sms/otp",{phoneNumber:t,otp:r}):Promise.reject({error:tp}),signInEmailOTP:(e,{email:r,options:n})=>tZ(r)?u("/signin/otp/email",{email:r,options:tW(t,n)}):Promise.reject({error:th}),verifyEmailOTP:(e,{email:t,otp:r})=>tZ(t)?u("/signin/otp/email/verify",{email:t,otp:r}):Promise.reject({error:th}),passwordlessEmail:(e,{email:r,options:n})=>{var i;return tZ(r)?null!=(i=e.user)&&i.isAnonymous?u("/user/deanonymize",{signInMethod:"passwordless",connection:"email",email:r,options:tW(t,n)},e.accessToken.value):u("/signin/passwordless/email",{email:r,options:tW(t,n)}):Promise.reject({error:th})},signInAnonymous:e=>u("/signin/anonymous"),signInMfaTotp:(e,t)=>{var r;let n=t.ticket||(null==(r=e.mfa)?void 0:r.ticket);return n?t2(n)?u("/signin/mfa/totp",{ticket:n,otp:t.otp}):Promise.reject({error:tf}):Promise.reject({error:tv})},signInSecurityKeyEmail:async(e,{email:t})=>{let r;if(!tZ(t))throw new tu(th);let n=await u("/signin/webauthn",{email:t});try{r=await tL(n)}catch(e){throw new tu(e)}return u("/signin/webauthn/verify",{email:t,credential:r})},refreshToken:async(e,t)=>{let r="TRY_TOKEN"===t.type?t.token:e.refreshToken.value;return{session:await u("/token",{refreshToken:r}),error:null}},signInSecurityKey:async()=>{try{let e;let t=await u("/signin/webauthn",{});try{e=await tL(t)}catch(e){throw new tu(e)}return u("/signin/webauthn/verify",{credential:e})}catch(e){throw new tu(e)}},signout:async(e,t)=>{let n=await u("/signout",{refreshToken:e.refreshToken.value,all:!!t.all},t.all?e.accessToken.value:void 0);if(r&&h)try{h.postMessage({type:"signout"})}catch{}return n},signUpEmailPassword:async(e,{email:r,password:n,options:i,requestOptions:s})=>{var o;return tZ(r)?t0(n)?null!=(o=e.user)&&o.isAnonymous?u("/user/deanonymize",{signInMethod:"email-password",email:r,password:n,options:tW(t,i)},e.accessToken.value,null==s?void 0:s.headers):u("/signup/email-password",{email:r,password:n,options:tW(t,i)},null,null==s?void 0:s.headers):Promise.reject({error:td}):Promise.reject({error:th})},signUpSecurityKey:async(e,{email:t,options:r,requestOptions:n})=>{let i;if(!tZ(t))return Promise.reject({error:th});let s=null==r?void 0:r.nickname;s&&delete r.nickname;let o=await u("/signup/webauthn",{email:t,options:r},null,null==n?void 0:n.headers);try{i=await tP(o)}catch(e){throw new tu(e)}return u("/signup/webauthn/verify",{credential:i,options:{redirectTo:null==r?void 0:r.redirectTo,nickname:s,displayName:null==r?void 0:r.displayName,...(null==r?void 0:r.metadata)&&{metadata:null==r?void 0:r.metadata}}})},importRefreshToken:async e=>{if(e.user&&e.refreshToken.value&&e.accessToken.value&&e.accessToken.expiresAt)return{session:{accessToken:e.accessToken.value,accessTokenExpiresIn:e.accessToken.expiresAt.getTime()-Date.now(),refreshToken:e.refreshToken.value,user:e.user},error:null};let t=null;if(a){let e=tQ("refreshToken")||null;if(e)try{return{session:await u("/token",{refreshToken:e}),error:null}}catch(e){t=e.error}else{let e=tQ("error"),t=tQ("errorDescription");if(e&&"social user already exists"!==t)return Promise.reject({session:null,error:{status:10,error:e,message:t||e}})}}let r=await c(ta);if(r)try{return{session:await u("/token",{refreshToken:r}),error:null}}catch(e){t=e.error}return t?Promise.reject({error:t,session:null}):{error:null,session:null}}},delays:{RETRY_IMPORT_TOKEN_DELAY:({importTokenAttempts:e})=>5e3*Math.pow(2,e-1)}})},t4=({backendUrl:e,clientUrl:t,interpreter:r})=>e2({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changeEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:eF({error:e=>th}),saveRequestError:eF({error:(e,{data:{error:t}})=>t}),reportError:e3(e=>({type:"ERROR",error:e.error})),reportSuccess:e3("SUCCESS")},guards:{invalidEmail:(e,{email:t})=>!tZ(t)},services:{requestChange:async(n,{email:i,options:s})=>(await tz(`${e}/user/email/change`,{newEmail:i,options:tW(t,s)},null==r?void 0:r.getSnapshot().context.accessToken.value)).data}}),t9=({backendUrl:e,interpreter:t})=>e2({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidPassword",actions:"saveInvalidPasswordError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidPasswordError:eF({error:e=>td}),saveRequestError:eF({error:(e,{data:{error:t}})=>t}),reportError:e3(e=>({type:"ERROR",error:e.error})),reportSuccess:e3("SUCCESS")},guards:{invalidPassword:(e,{password:t})=>!t0(t)},services:{requestChange:(r,{password:n,ticket:i})=>tz(`${e}/user/password`,{newPassword:n,ticket:i},null==t?void 0:t.getSnapshot().context.accessToken.value)}}),t5=({backendUrl:e,clientUrl:t})=>e2({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:eF({error:e=>th}),saveRequestError:eF({error:(e,{data:{error:t}})=>t}),reportError:e3(e=>({type:"ERROR",error:e.error})),reportSuccess:e3("SUCCESS")},guards:{invalidEmail:(e,{email:t})=>!tZ(t)},services:{requestChange:(r,{email:n,options:i})=>tz(`${e}/user/password/reset`,{email:n,options:tW(t,i)})}}),t8=({backendUrl:e,clientUrl:t})=>e2({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"sendVerificationEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"request",id:"request",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:eF({error:e=>th}),saveRequestError:eF({error:(e,{data:{error:t}})=>t}),reportError:e3(e=>({type:"ERROR",error:e.error})),reportSuccess:e3("SUCCESS")},guards:{invalidEmail:(e,{email:t})=>!tZ(t)},services:{request:async(r,{email:n,options:i})=>(await tz(`${e}/user/email/send-verification-email`,{email:n,options:tW(t,i)})).data}});class t6{constructor({clientStorageType:e="web",autoSignIn:t=!0,autoRefreshToken:r=!0,start:n=!0,backendUrl:i,clientUrl:s,broadcastKey:o,devTools:a,...c}){var l;if(this._started=!1,this._subscriptionsQueue=new Set,this._subscriptions=new Set,this.backendUrl=i,this.clientUrl=s,this._machine=t3({...c,backendUrl:i,clientUrl:s,broadcastKey:o,clientStorageType:e,autoSignIn:t,autoRefreshToken:r}),n&&this.start({devTools:a}),"undefined"!=typeof window&&o)try{this._channel=new BroadcastChannel(o),t&&(null==(l=this._channel)||l.addEventListener("message",e=>{var t;let{type:r,payload:n}=e.data;if("broadcast_session"===r){let e=null==(t=this.interpreter)?void 0:t.getSnapshot().context,r=null==e?void 0:e.refreshToken.value;this.interpreter&&n.token&&n.token!==r&&this.interpreter.send("SESSION_UPDATE",{data:{session:{user:n.user,accessToken:n.accessToken,refreshToken:n.token,accessTokenExpiresIn:n.expiresInSeconds}}})}})),this._channel.addEventListener("message",e=>{let{type:t}=e.data;"signout"===t&&this.interpreter&&this.interpreter.send("SIGNOUT")})}catch{}}start({devTools:e=!1,initialSession:t,interpreter:r}={}){var n,i;let s={...this.machine.context,accessToken:{...this.machine.context.accessToken},refreshToken:{...this.machine.context.refreshToken}};t&&(s.user=t.user,s.refreshToken.value=null!=(n=t.refreshToken)?n:null,s.accessToken.value=null!=(i=t.accessToken)?i:null,s.accessToken.expiresAt=new Date(Date.now()+1e3*t.accessTokenExpiresIn));let o=this.machine.withContext(s);this._interpreter||(this._interpreter=r||tr(o,{devTools:e})),this._started&&"undefined"!=typeof window||(this._interpreter.initialized&&(this._interpreter.stop(),this._subscriptions.forEach(e=>e())),this._interpreter.start(o.initialState),this._subscriptionsQueue.forEach(e=>e(this))),this._started=!0}get machine(){return this._machine}get interpreter(){return this._interpreter}get started(){return this._started}subscribe(e){if(!this.started)return this._subscriptionsQueue.add(e),()=>{console.log("onTokenChanged was added before the interpreter started. Cannot unsubscribe listener.")};{let t=e(this);return this._subscriptions.add(t),t}}}let t7=async({backendUrl:e,interpreter:t},r)=>{try{let n;let{data:i}=await tz(`${e}/user/webauthn/add`,{},null==t?void 0:t.getSnapshot().context.accessToken.value);try{n=await tP(i)}catch(e){throw new tu(e)}let{data:s}=await tz(`${e}/user/webauthn/verify`,{credential:n,nickname:r},null==t?void 0:t.getSnapshot().context.accessToken.value);return{key:s,isError:!1,error:null,isSuccess:!0}}catch(t){let{error:e}=t;return{isError:!0,error:e,isSuccess:!1}}},re=async(e,t,r)=>new Promise(n=>{e.send("REQUEST",{email:t,options:r}),e.onTransition(e=>{e.matches({idle:"error"})?n({error:e.context.error,isError:!0,needsEmailVerification:!1}):e.matches({idle:"success"})&&n({error:null,isError:!1,needsEmailVerification:!0})})}),rt=async(e,t,r)=>new Promise(n=>{e.send("REQUEST",{password:t,ticket:r}),e.onTransition(e=>{e.matches({idle:"error"})?n({error:e.context.error,isError:!0,isSuccess:!1}):e.matches({idle:"success"})&&n({error:null,isError:!1,isSuccess:!0})})}),rr=async(e,t,r)=>new Promise(n=>{e.send("REQUEST",{email:t,options:r}),e.onTransition(e=>{e.matches({idle:"error"})?n({error:e.context.error,isError:!0,isSent:!1}):e.matches({idle:"success"})&&n({error:null,isError:!1,isSent:!0})})}),rn=(e,t,r)=>new Promise(n=>{e.send("REQUEST",{email:t,options:r}),e.onTransition(e=>{e.matches({idle:"error"})?n({error:e.context.error,isError:!0,isSent:!1}):e.matches({idle:"success"})&&n({error:null,isError:!1,isSent:!0})})}),ri=e=>new Promise(t=>{let{changed:r}=e.send("SIGNIN_ANONYMOUS");r||t({isSuccess:!1,isError:!0,error:tg,user:null,accessToken:null,refreshToken:null}),e.onTransition(e=>{e.matches({authentication:"signedIn"})&&t({isSuccess:!0,isError:!1,error:null,user:e.context.user,accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value}),e.matches({authentication:{signedOut:"failed"}})&&t({isSuccess:!1,isError:!0,error:e.context.errors.authentication||null,user:null,accessToken:null,refreshToken:null})})}),rs=(e,t,r)=>new Promise(n=>{let{changed:i,context:s}=e.send("SIGNIN_PASSWORD",{email:t,password:r});if(!i)return n({accessToken:s.accessToken.value,refreshToken:s.refreshToken.value,error:tg,isError:!0,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:s.user});e.onTransition(e=>{e.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?n({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,needsMfaOtp:!1,mfa:null,user:null}):e.matches({authentication:{signedOut:"needsMfa"}})?n({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!0,mfa:e.context.mfa,user:null}):e.matches({authentication:{signedOut:"failed"}})?n({accessToken:null,refreshToken:null,error:e.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:null}):e.matches({authentication:"signedIn"})&&n({accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:e.context.user})})}),ro=(e,t,r)=>new Promise(n=>{let{changed:i}=e.send("PASSWORDLESS_EMAIL",{email:t,options:r});if(!i)return n({error:tg,isError:!0,isSuccess:!1});e.onTransition(e=>{e.matches("registration.incomplete.failed")?n({error:e.context.errors.registration||null,isError:!0,isSuccess:!1}):e.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})&&n({error:null,isError:!1,isSuccess:!0})})}),ra=(e,t)=>new Promise(r=>{let{changed:n,context:i}=e.send({type:"SIGNIN_SECURITY_KEY_EMAIL",email:t});if(!n)return r({accessToken:i.accessToken.value,refreshToken:i.refreshToken.value,error:tg,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:i.user});e.onTransition(e=>{e.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?r({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):e.matches({authentication:{signedOut:"failed"}})?r({accessToken:null,refreshToken:null,error:e.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):e.matches({authentication:"signedIn"})&&r({accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:e.context.user})})});function rc(e){return{error:e.message||"Something went wrong!",status:e.status||1,message:e.message||"Something went wrong!"}}let rl=async(e,t)=>{var r,n;let i,s;let o=null==(r=e.interpreter)?void 0:r.getSnapshot(),a=null==o?void 0:o.context.accessToken.value;try{i=(await tz(`${e.backendUrl}/elevate/webauthn`,{email:t},a)).data}catch(e){return{error:rc(e),isError:!0,isSuccess:!1,elevated:!1}}try{s=await tL(i)}catch(e){return{error:rc(e),isError:!0,isSuccess:!1,elevated:!1}}try{let{data:{session:r},error:i}=await tz(`${e.backendUrl}/elevate/webauthn/verify`,{email:t,credential:s},a);return r&&!i?(null==(n=e.interpreter)||n.send({type:"SESSION_UPDATE",data:{session:r}}),{error:null,isError:!1,isSuccess:!0,elevated:!0}):{error:i,isError:!0,isSuccess:!1,elevated:!1}}catch(t){let{error:e}=t;return{error:e,isError:!0,isSuccess:!1,elevated:!1}}},ru=(e,t,r)=>new Promise(n=>{let{changed:i,context:s}=e.send("SIGNIN_MFA_TOTP",{otp:t,ticket:r});if(!i)return n({accessToken:s.accessToken.value,refreshToken:s.refreshToken.value,error:tg,isError:!0,isSuccess:!1,user:s.user});e.onTransition(e=>{e.matches({authentication:{signedOut:"failed"}})?n({accessToken:null,refreshToken:null,error:e.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null}):e.matches({authentication:"signedIn"})&&n({accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,user:e.context.user})})}),rh=(e,t)=>new Promise(r=>{let{changed:n}=e.send("SIGNIN_PAT",{pat:t});n||r({isSuccess:!1,isError:!0,error:tg,user:null,accessToken:null,refreshToken:null}),e.onTransition(e=>e.matches({authentication:{signedOut:"failed"}})?r({accessToken:null,refreshToken:null,user:null,error:e.context.errors.authentication||null,isError:!0,isSuccess:!1}):e.matches({authentication:"signedIn"})?r({accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value,user:e.context.user,error:null,isError:!1,isSuccess:!0}):void 0)}),rd=(e,t,r)=>new Promise(n=>{let{changed:i}=e.send("PASSWORDLESS_SMS",{phoneNumber:t,options:r});if(!i)return n({error:tg,isError:!0,isSuccess:!1,needsOtp:!1});e.onTransition(e=>{e.matches("registration.incomplete.needsOtp")?n({error:null,isError:!1,isSuccess:!1,needsOtp:!0}):e.matches("registration.incomplete.failed")&&n({error:e.context.errors.authentication||null,isError:!0,isSuccess:!1,needsOtp:!1})})}),rp=(e,t,r)=>new Promise(n=>{let{changed:i}=e.send({type:"PASSWORDLESS_SMS_OTP",phoneNumber:t,otp:r});if(!i)return n({error:tg,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null});e.onTransition(e=>{e.matches({authentication:"signedIn"})?n({error:null,isError:!1,isSuccess:!0,user:e.context.user,accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value}):e.matches({registration:{incomplete:"failed"}})&&n({error:e.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null})})}),rf=async(e,t)=>new Promise(r=>{let{event:n}=e.send("SIGNOUT",{all:t});if("SIGNED_OUT"!==n.type)return r({isSuccess:!1,isError:!0,error:tT});e.onTransition(e=>{e.matches({authentication:{signedOut:"success"}})?r({isSuccess:!0,isError:!1,error:null}):e.matches("authentication.signedOut.failed")&&r({isSuccess:!1,isError:!0,error:e.context.errors.signout||null})})}),rv=(e,t,r,n,i)=>new Promise(s=>{let{changed:o,context:a}=e.send("SIGNUP_EMAIL_PASSWORD",{email:t,password:r,options:n,requestOptions:i});if(!o)return s({error:tg,accessToken:a.accessToken.value,refreshToken:a.refreshToken.value,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:a.user});e.onTransition(e=>{e.matches("registration.incomplete.failed")?s({accessToken:null,refreshToken:null,error:e.context.errors.registration||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):e.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?s({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):e.matches({authentication:"signedIn",registration:"complete"})&&s({accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:e.context.user})})}),ry=(e,t,r,n)=>new Promise(i=>{let{changed:s,context:o}=e.send("SIGNUP_SECURITY_KEY",{email:t,options:r,requestOptions:n});if(!s)return i({error:tg,accessToken:o.accessToken.value,refreshToken:o.refreshToken.value,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:o.user});e.onTransition(e=>{e.matches("registration.incomplete.failed")?i({accessToken:null,refreshToken:null,error:e.context.errors.registration||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):e.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?i({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):e.matches({authentication:"signedIn",registration:"complete"})&&i({accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:e.context.user})})}),rm=(e,t,r)=>new Promise(n=>{let{changed:i}=e.send("SIGNIN_EMAIL_OTP",{email:t,options:r});if(!i)return n({error:tg,isError:!0,isSuccess:!1,needsOtp:!1});e.onTransition(e=>{e.matches("registration.incomplete.needsOtp")?n({error:null,isError:!1,isSuccess:!0,needsOtp:!0}):e.matches("registration.incomplete.failed")&&n({error:e.context.errors.authentication||null,isError:!0,isSuccess:!1,needsOtp:!1})})}),rg=(e,t,r)=>new Promise(n=>{let{changed:i}=e.send({type:"VERIFY_EMAIL_OTP",email:t,otp:r});if(!i)return n({error:tg,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null});e.onTransition(e=>{e.matches({authentication:"signedIn"})?n({error:null,isError:!1,isSuccess:!0,user:e.context.user,accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value}):e.matches({registration:{incomplete:"failed"}})&&n({error:e.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null})})}),rT=(e,{provider:t,idToken:r,nonce:n})=>new Promise(i=>{let{changed:s}=e.send("SIGNIN_ID_TOKEN",{provider:t,idToken:r,...n&&{nonce:n}});s||i({isSuccess:!1,isError:!0,error:tg,user:null,accessToken:null,refreshToken:null}),e.onTransition(e=>e.matches({authentication:{signedOut:"failed"}})?i({accessToken:null,refreshToken:null,user:null,error:e.context.errors.authentication||null,isError:!0,isSuccess:!1}):e.matches({authentication:"signedIn"})?i({accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value,user:e.context.user,error:null,isError:!1,isSuccess:!0}):void 0)}),rE=async({backendUrl:e,interpreter:t},{provider:r,idToken:n,nonce:i})=>{try{return await tz(`${e}/link/idtoken`,{provider:r,idToken:n,...i&&{nonce:i}},null==t?void 0:t.getSnapshot().context.accessToken.value),{isError:!1,error:null,isSuccess:!0}}catch(t){let{error:e}=t;return{isError:!0,error:e,isSuccess:!1}}},rS=e=>new Promise(t=>{let{changed:r,context:n}=e.send({type:"SIGNIN_SECURITY_KEY"});if(!r)return t({accessToken:n.accessToken.value,refreshToken:n.refreshToken.value,error:tg,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:n.user});e.onTransition(e=>{e.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?t({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):e.matches({authentication:{signedOut:"failed"}})?t({accessToken:null,refreshToken:null,error:e.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):e.matches({authentication:"signedIn"})&&t({accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:e.context.user})})}),rw=async({backendUrl:e,interpreter:t},{expiresAt:r,metadata:n})=>{try{let{data:i}=await tz(`${e}/pat`,{expiresAt:r.toISOString(),metadata:n},null==t?void 0:t.getSnapshot().context.accessToken.value);return{data:i?{id:i.id||null,personalAccessToken:i.personalAccessToken||null}:null,isError:!1,error:null,isSuccess:!0}}catch(t){let{error:e}=t;return{isError:!0,error:e,isSuccess:!1,data:null}}};class rk{constructor({url:e,broadcastKey:t,autoRefreshToken:r=!0,autoSignIn:n=!0,clientStorage:i,clientStorageType:s,refreshIntervalTime:o,start:a=!0}){var c;this.url=e,this._client=new t6({backendUrl:e,clientUrl:"undefined"!=typeof window&&(null==(c=window.location)?void 0:c.origin)||"",broadcastKey:t,autoRefreshToken:r,autoSignIn:n,start:a,clientStorage:i,clientStorageType:s,refreshIntervalTime:o})}async signUp(e,t){let r=await this.waitUntilReady();if("securityKey"in e){let{email:n,options:i}=e;return tq(await ry(r,n,i,t))}let{email:n,password:i,options:s}=e;return tq(await rv(r,n,i,s,t))}async connectProvider(e){let t=(await this.waitUntilReady()).getSnapshot().context.accessToken.value,{provider:r,options:n}=e,i=tJ(`${this._client.backendUrl}/signin/provider/${r}`,tW(this._client.clientUrl,{...n,connect:t}));return tG()&&(window.location.href=i),{providerUrl:i}}async signInIdToken(e){let t=await this.waitUntilReady();return{...tq(await rT(t,e)),mfa:null}}async linkIdToken(e){return rE(this._client,e)}async signIn(e){let t=await this.waitUntilReady();if(!e)return{...tq(await ri(t)),mfa:null};if("provider"in e){let{provider:t,options:r}=e,n=tJ(`${this._client.backendUrl}/signin/provider/${t}`,tW(this._client.clientUrl,r));return tG()&&(window.location.href=n),{providerUrl:n,provider:t,session:null,mfa:null,error:null}}if("email"in e&&"password"in e){let r=await rs(t,e.email,e.password);return r.needsEmailVerification?{session:null,mfa:null,error:tE}:r.needsMfaOtp?{session:null,mfa:r.mfa,error:null}:{...tq(r),mfa:null}}if("email"in e&&"securityKey"in e){if(!0!==e.securityKey)throw Error("securityKey must be true");return{...tq(await ra(t,e.email)),mfa:null}}if("email"in e){let{email:r,options:n}=e,{error:i}=await ro(t,r,n);return{session:null,mfa:null,error:i}}if("phoneNumber"in e&&"otp"in e)return{...tq(await rp(t,e.phoneNumber,e.otp)),mfa:null};if("phoneNumber"in e){let{error:r}=await rd(t,e.phoneNumber,e.options);return{error:r,mfa:null,session:null}}return"otp"in e?{...tq(await ru(t,e.otp,e.ticket)),mfa:null}:{error:tw,mfa:null,session:null}}async signInPAT(e){let t=await this.waitUntilReady();return tq(await rh(t,e))}async signInEmailOTP(e,t){let r=await this.waitUntilReady(),{error:n}=await rm(r,e,t);return{error:n,session:null,mfa:null}}async verifyEmailOTP(e,t){let r=await this.waitUntilReady();return{...tq(await rg(r,e,t)),mfa:null}}async signInSecurityKey(){let e=await this.waitUntilReady();return{...tq(await rS(e)),mfa:null}}async signOut(e){let t=await this.waitUntilReady(),{error:r}=await rf(t,null==e?void 0:e.all);return{error:r}}async resetPassword({email:e,options:t}){let r=tr(t5(this._client)).start(),{error:n}=await rr(r,e,t);return{error:n}}async changePassword({newPassword:e,ticket:t}){let r=tr(t9(this._client)).start(),{error:n}=await rt(r,e,t);return{error:n}}async sendVerificationEmail({email:e,options:t}){let r=tr(t8(this._client)).start(),{error:n}=await rn(r,e,t);return{error:n}}async changeEmail({newEmail:e,options:t}){let r=tr(t4(this._client)).start(),{error:n}=await re(r,e,t);return{error:n}}async deanonymize(e){let t=await this.waitUntilReady();if("passwordless"===e.signInMethod){if("email"===e.connection){let{error:r}=await ro(t,e.email,e.options);return{error:r}}if("sms"===e.connection){let{error:r}=await rd(t,e.phoneNumber,e.options);return{error:r}}}if("email-password"===e.signInMethod){let{error:r}=await rv(t,e.email,e.password,e.options);return{error:r}}throw Error("Unknown deanonymization method")}async addSecurityKey(e){let{error:t,key:r}=await t7(this._client,e);return{error:t,key:r}}async elevateEmailSecurityKey(e){if(!e)throw Error("A user email is required");return{...await rl(this._client,e),mfa:null}}async createPAT(e,t){return rw(this._client,{expiresAt:e,metadata:t})}onTokenChanged(e){return this._client.subscribe(()=>{var t;let r=null==(t=this._client.interpreter)?void 0:t.onTransition(({event:t,context:r})=>{"TOKEN_CHANGED"===t.type&&e(tK(r))});return()=>null==r?void 0:r.stop()})}onAuthStateChanged(e){return this._client.subscribe(()=>{var t;let r=null==(t=this._client.interpreter)?void 0:t.onTransition(({event:t,context:r})=>{("SIGNED_IN"===t.type||"SIGNED_OUT"===t.type)&&e(t.type,tK(r))});return()=>null==r?void 0:r.stop()})}isAuthenticated(){var e;return!!(null!=(e=this._client.interpreter)&&e.getSnapshot().matches({authentication:"signedIn"}))}async isAuthenticatedAsync(){return(await this.waitUntilReady()).getSnapshot().matches({authentication:"signedIn"})}getAuthenticationStatus(){var e;let t=(null==(e=this.client.interpreter)?void 0:e.getSnapshot().context.importTokenAttempts)||0;return this.isReady()?{isAuthenticated:this.isAuthenticated(),isLoading:!1,connectionAttempts:t}:{isAuthenticated:!1,isLoading:!0,connectionAttempts:t}}getAccessToken(){var e,t;return null!=(t=null==(e=this._client.interpreter)?void 0:e.getSnapshot().context.accessToken.value)?t:void 0}getDecodedAccessToken(){let e=this.getAccessToken();return e?w(e):null}getHasuraClaims(){var e;return(null==(e=this.getDecodedAccessToken())?void 0:e["https://hasura.io/jwt/claims"])||null}getHasuraClaim(e){var t;return(null==(t=this.getHasuraClaims())?void 0:t[e.startsWith("x-hasura-")?e:`x-hasura-${e}`])||null}async refreshSession(e){try{let t=await this.waitUntilReady();return new Promise(r=>{let n=e||t.getSnapshot().context.refreshToken.value;if(!n)return r({session:null,error:ty});let{changed:i}=t.send("TRY_TOKEN",{token:n});if(!i)return r({session:null,error:tm});t.onTransition(e=>{e.matches({token:{idle:"error"}})?r({session:null,error:tS}):"TOKEN_CHANGED"===e.event.type&&r({session:tK(e.context),error:null})})})}catch(e){return{session:null,error:e.message}}}getSession(){var e,t;return tK(null==(t=null==(e=this._client.interpreter)?void 0:e.getSnapshot())?void 0:t.context)}async initWithSession({session:e}){this.client.start({initialSession:e}),await this.waitUntilReady()}getUser(){var e,t,r;return(null==(r=null==(t=null==(e=this._client.interpreter)?void 0:e.getSnapshot())?void 0:t.context)?void 0:r.user)||null}waitUntilReady(){let e=this._client.interpreter;if(!e)throw Error("Auth interpreter not set");return e.getSnapshot().hasTag("loading")?new Promise((t,r)=>{let n=setTimeout(()=>r("The state machine is not yet ready after 15 seconds."),15e3);e.onTransition(r=>{if(!r.hasTag("loading"))return clearTimeout(n),t(e)})}):Promise.resolve(e)}isReady(){var e,t;return!(null!=(t=null==(e=this._client.interpreter)?void 0:e.getSnapshot())&&t.hasTag("loading"))}get client(){return this._client}}var rb=r(6230),rx=r.n(rb),rI=Object.defineProperty,rA=(e,t,r)=>t in e?rI(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,r_=(e,t,r)=>rA(e,"symbol"!=typeof t?t+"":t,r);let rO=globalThis.fetch,rN=async(e,t,{accessToken:r,name:n,fileId:i,bucketId:s,adminSecret:o,onUploadProgress:a,headers:c={}}={})=>{var l;let u={...c};s&&t.append("bucket-id",s),o&&(u["x-hasura-admin-secret"]=o),r&&(u.Authorization=`Bearer ${r}`);let h=`${e}/files`;if("undefined"==typeof XMLHttpRequest)try{t instanceof rx()&&(rO=to()().fetch);let e=await rO(h,{method:"POST",headers:u,body:t}),r=await e.json();return e.ok?{fileMetadata:r,error:null}:{error:{status:e.status,message:(null==(l=null==r?void 0:r.error)?void 0:l.message)||e.statusText,error:e.statusText},fileMetadata:null}}catch(e){return{error:{status:0,message:e.message,error:e.message},fileMetadata:null}}return new Promise(e=>{let r=new XMLHttpRequest;r.responseType="json",r.onload=()=>{var t,n,i,s,o,a,c,l;return r.status<200||r.status>=300?e({fileMetadata:null,error:{error:null!=(o=null!=(s=null==(n=null==(t=r.response)?void 0:t.error)?void 0:n.message)?s:null==(i=r.response)?void 0:i.error)?o:r.response,message:null!=(l=null==(c=null==(a=r.response)?void 0:a.error)?void 0:c.message)?l:r.response,status:r.status}}):e({fileMetadata:r.response,error:null})},r.onerror=()=>e({fileMetadata:null,error:{error:r.statusText,message:r.statusText,status:r.status}}),a&&r.upload.addEventListener("progress",a,!1),r.open("POST",h,!0),Object.entries(u).forEach(([e,t])=>{r.setRequestHeader(e,t)}),r.send(t)})};function rR(e,t){if(!t||0===Object.keys(t).length)return e;let r=new URL(e);return Object.entries(Object.entries(t).reduce((e,[t,r])=>({...e,[t.charAt(0)]:r}),{})).forEach(([e,t])=>{t&&r.searchParams.set(e,t)}),r.toString()}void 0===n&&(n=to()().fetch);class rD{constructor({url:e}){r_(this,"url"),r_(this,"accessToken"),r_(this,"adminSecret"),r_(this,"headers",{}),this.url=e}async uploadFormData({formData:e,bucketId:t,headers:r}){let{error:n,fileMetadata:i}=await rN(this.url,e,{bucketId:t,headers:{...this.headers,...r},accessToken:this.accessToken,adminSecret:this.adminSecret});return n?{fileMetadata:null,error:n}:!i||"processedFiles"in i?{fileMetadata:i,error:null}:{fileMetadata:{processedFiles:[i]},error:null}}async uploadFile({file:e,bucketId:t,id:r,name:n,headers:i}){let s="undefined"==typeof window?new(rx()):new FormData;s.append("file[]",e),s.append("metadata[]",JSON.stringify({id:r,name:n}));let{error:o,fileMetadata:a}=await rN(this.url,s,{accessToken:this.accessToken,adminSecret:this.adminSecret,bucketId:t,fileId:r,name:n,headers:{...this.headers,...i}});return o?{fileMetadata:null,error:o}:a&&"processedFiles"in a?{fileMetadata:a.processedFiles[0],error:null}:{fileMetadata:a,error:null}}async downloadFile(e){try{let{fileId:t,headers:r,...i}=e,s=rR(`${this.url}/files/${t}`,i),o=await n(s,{method:"GET",headers:{...this.generateAuthHeaders(),...this.headers,...r}});if(!o.ok)throw Error(await o.text());return{file:await o.blob(),error:null}}catch(e){return{file:null,error:e}}}async getPresignedUrl(e){try{let{fileId:t,headers:r}=e,i=await n(`${this.url}/files/${t}/presignedurl`,{method:"GET",headers:{...this.generateAuthHeaders(),...this.headers,...r}});if(!i.ok)throw Error(await i.text());return{presignedUrl:await i.json(),error:null}}catch(e){return{presignedUrl:null,error:e}}}async delete(e){try{let{fileId:t,headers:r}=e,i=await n(`${this.url}/files/${t}`,{method:"DELETE",headers:{...this.generateAuthHeaders(),...this.headers,...r}});if(!i.ok)throw Error(await i.text());return{error:null}}catch(e){return{error:e}}}setAccessToken(e){return this.accessToken=e,this}setAdminSecret(e){return this.adminSecret=e,this}getHeaders(){return this.headers}setHeaders(e){return e&&(this.headers={...this.headers,...e}),this}unsetHeaders(){let e=this.headers["x-hasura-role"];return this.headers=e?{"x-hasura-role":e}:{},this}generateAuthHeaders(){if(!(!this.adminSecret&&!this.accessToken))return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:{Authorization:`Bearer ${this.accessToken}`}}}class rC{constructor({url:e,adminSecret:t}){r_(this,"url"),r_(this,"api"),this.url=e,this.api=new rD({url:e}),this.setAdminSecret(t)}async upload(e){return"file"in e?this.api.uploadFile(e):this.api.uploadFormData(e)}getPublicUrl(e){let{fileId:t,...r}=e;return rR(`${this.url}/files/${t}`,r)}async getPresignedUrl(e){let{fileId:t,headers:r,...n}=e,{presignedUrl:i,error:s}=await this.api.getPresignedUrl(e);if(s)return{presignedUrl:null,error:s};if(!i)return{presignedUrl:null,error:Error("Invalid file id")};let o=rR(i.url,n);return{presignedUrl:{...i,url:o},error:null}}async download(e){let{file:t,error:r}=await this.api.downloadFile(e);return r?{file:null,error:r}:t?{file:t,error:null}:{file:null,error:Error("File does not exist")}}async delete(e){let{error:t}=await this.api.delete(e);return t?{error:t}:{error:null}}setAccessToken(e){return this.api.setAccessToken(e),this}setAdminSecret(e){return this.api.setAdminSecret(e),this}getHeaders(){return this.api.getHeaders()}setHeaders(e){return this.api.setHeaders(e),this}unsetHeaders(){return this.api.unsetHeaders(),this}}void 0===i&&(i=rx());let{pure:rP,sendParent:rU}=E;var rL=r(3144),rM=r.n(rL);let rj=/\r\n|[\n\r]/g;function rF(e,t){let r=0,n=1;for(let i of e.body.matchAll(rj)){if("number"==typeof i.index||function(e,t){if(!e)throw Error("Unexpected invariant triggered.")}(!1),i.index>=t)break;r=i.index+i[0].length,n+=1}return{line:n,column:t+1-r}}function rV(e,t){let r=e.locationOffset.column-1,n="".padStart(r)+e.body,i=t.line-1,s=e.locationOffset.line-1,o=t.line+s,a=1===t.line?r:0,c=t.column+a,l=`${e.name}:${o}:${c}
`,u=n.split(/\r\n|[\n\r]/g),h=u[i];if(h.length>120){let e=Math.floor(c/80),t=[];for(let e=0;e<h.length;e+=80)t.push(h.slice(e,e+80));return l+rB([[`${o} |`,t[0]],...t.slice(1,e+1).map(e=>["|",e]),["|","^".padStart(c%80)],["|",t[e+1]]])}return l+rB([[`${o-1} |`,u[i-1]],[`${o} |`,h],["|","^".padStart(c)],[`${o+1} |`,u[i+1]]])}function rB(e){let t=e.filter(([e,t])=>void 0!==t),r=Math.max(...t.map(([e])=>e.length));return t.map(([e,t])=>e.padStart(r)+(t?" "+t:"")).join("\n")}class r$ extends Error{constructor(e,...t){var r,n,i,s;let{nodes:o,source:a,positions:c,path:l,originalError:u,extensions:h}=function(e){let t=e[0];return null==t||"kind"in t||"length"in t?{nodes:t,source:e[1],positions:e[2],path:e[3],originalError:e[4],extensions:e[5]}:t}(t);super(e),this.name="GraphQLError",this.path=null!=l?l:void 0,this.originalError=null!=u?u:void 0,this.nodes=rK(Array.isArray(o)?o:o?[o]:void 0);let d=rK(null===(r=this.nodes)||void 0===r?void 0:r.map(e=>e.loc).filter(e=>null!=e));this.source=null!=a?a:null==d?void 0:null===(n=d[0])||void 0===n?void 0:n.source,this.positions=null!=c?c:null==d?void 0:d.map(e=>e.start),this.locations=c&&a?c.map(e=>rF(a,e)):null==d?void 0:d.map(e=>rF(e.source,e.start));let p="object"==typeof(s=null==u?void 0:u.extensions)&&null!==s?null==u?void 0:u.extensions:void 0;this.extensions=null!==(i=null!=h?h:p)&&void 0!==i?i:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),null!=u&&u.stack?Object.defineProperty(this,"stack",{value:u.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,r$):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let e=this.message;if(this.nodes){for(let r of this.nodes)if(r.loc){var t;e+="\n\n"+rV((t=r.loc).source,rF(t.source,t.start))}}else if(this.source&&this.locations)for(let t of this.locations)e+="\n\n"+rV(this.source,t);return e}toJSON(){let e={message:this.message};return null!=this.locations&&(e.locations=this.locations),null!=this.path&&(e.path=this.path),null!=this.extensions&&Object.keys(this.extensions).length>0&&(e.extensions=this.extensions),e}}function rK(e){return void 0===e||0===e.length?void 0:e}function rq(e,t,r){return new r$(`Syntax Error: ${r}`,{source:e,positions:[t]})}class rG{constructor(e,t,r){this.start=e.start,this.end=t.end,this.startToken=e,this.endToken=t,this.source=r}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class rH{constructor(e,t,r,n,i,s){this.kind=e,this.start=t,this.end=r,this.line=n,this.column=i,this.value=s,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}let rY={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},rz=new Set(Object.keys(rY));function rJ(e){let t=null==e?void 0:e.kind;return"string"==typeof t&&rz.has(t)}function rW(e){return 9===e||32===e}function rQ(e){return e>=48&&e<=57}function rX(e){return e>=97&&e<=122||e>=65&&e<=90}function rZ(e){return rX(e)||95===e}(c=y||(y={})).QUERY="query",c.MUTATION="mutation",c.SUBSCRIPTION="subscription",(l=m||(m={})).QUERY="QUERY",l.MUTATION="MUTATION",l.SUBSCRIPTION="SUBSCRIPTION",l.FIELD="FIELD",l.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",l.FRAGMENT_SPREAD="FRAGMENT_SPREAD",l.INLINE_FRAGMENT="INLINE_FRAGMENT",l.VARIABLE_DEFINITION="VARIABLE_DEFINITION",l.SCHEMA="SCHEMA",l.SCALAR="SCALAR",l.OBJECT="OBJECT",l.FIELD_DEFINITION="FIELD_DEFINITION",l.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",l.INTERFACE="INTERFACE",l.UNION="UNION",l.ENUM="ENUM",l.ENUM_VALUE="ENUM_VALUE",l.INPUT_OBJECT="INPUT_OBJECT",l.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION",(u=g||(g={})).NAME="Name",u.DOCUMENT="Document",u.OPERATION_DEFINITION="OperationDefinition",u.VARIABLE_DEFINITION="VariableDefinition",u.SELECTION_SET="SelectionSet",u.FIELD="Field",u.ARGUMENT="Argument",u.FRAGMENT_SPREAD="FragmentSpread",u.INLINE_FRAGMENT="InlineFragment",u.FRAGMENT_DEFINITION="FragmentDefinition",u.VARIABLE="Variable",u.INT="IntValue",u.FLOAT="FloatValue",u.STRING="StringValue",u.BOOLEAN="BooleanValue",u.NULL="NullValue",u.ENUM="EnumValue",u.LIST="ListValue",u.OBJECT="ObjectValue",u.OBJECT_FIELD="ObjectField",u.DIRECTIVE="Directive",u.NAMED_TYPE="NamedType",u.LIST_TYPE="ListType",u.NON_NULL_TYPE="NonNullType",u.SCHEMA_DEFINITION="SchemaDefinition",u.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",u.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",u.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",u.FIELD_DEFINITION="FieldDefinition",u.INPUT_VALUE_DEFINITION="InputValueDefinition",u.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",u.UNION_TYPE_DEFINITION="UnionTypeDefinition",u.ENUM_TYPE_DEFINITION="EnumTypeDefinition",u.ENUM_VALUE_DEFINITION="EnumValueDefinition",u.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",u.DIRECTIVE_DEFINITION="DirectiveDefinition",u.SCHEMA_EXTENSION="SchemaExtension",u.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",u.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",u.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",u.UNION_TYPE_EXTENSION="UnionTypeExtension",u.ENUM_TYPE_EXTENSION="EnumTypeExtension",u.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension",(h=T||(T={})).SOF="<SOF>",h.EOF="<EOF>",h.BANG="!",h.DOLLAR="$",h.AMP="&",h.PAREN_L="(",h.PAREN_R=")",h.SPREAD="...",h.COLON=":",h.EQUALS="=",h.AT="@",h.BRACKET_L="[",h.BRACKET_R="]",h.BRACE_L="{",h.PIPE="|",h.BRACE_R="}",h.NAME="Name",h.INT="Int",h.FLOAT="Float",h.STRING="String",h.BLOCK_STRING="BlockString",h.COMMENT="Comment";class r0{constructor(e){let t=new rH(T.SOF,0,0,0,0);this.source=e,this.lastToken=t,this.token=t,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let e=this.token;if(e.kind!==T.EOF)do if(e.next)e=e.next;else{let t=function(e,t){let r=e.source.body,n=r.length,i=t;for(;i<n;){let t=r.charCodeAt(i);switch(t){case 65279:case 9:case 32:case 44:++i;continue;case 10:++i,++e.line,e.lineStart=i;continue;case 13:10===r.charCodeAt(i+1)?i+=2:++i,++e.line,e.lineStart=i;continue;case 35:return function(e,t){let r=e.source.body,n=r.length,i=t+1;for(;i<n;){let e=r.charCodeAt(i);if(10===e||13===e)break;if(r1(e))++i;else if(r2(r,i))i+=2;else break}return r5(e,T.COMMENT,t,i,r.slice(t+1,i))}(e,i);case 33:return r5(e,T.BANG,i,i+1);case 36:return r5(e,T.DOLLAR,i,i+1);case 38:return r5(e,T.AMP,i,i+1);case 40:return r5(e,T.PAREN_L,i,i+1);case 41:return r5(e,T.PAREN_R,i,i+1);case 46:if(46===r.charCodeAt(i+1)&&46===r.charCodeAt(i+2))return r5(e,T.SPREAD,i,i+3);break;case 58:return r5(e,T.COLON,i,i+1);case 61:return r5(e,T.EQUALS,i,i+1);case 64:return r5(e,T.AT,i,i+1);case 91:return r5(e,T.BRACKET_L,i,i+1);case 93:return r5(e,T.BRACKET_R,i,i+1);case 123:return r5(e,T.BRACE_L,i,i+1);case 124:return r5(e,T.PIPE,i,i+1);case 125:return r5(e,T.BRACE_R,i,i+1);case 34:if(34===r.charCodeAt(i+1)&&34===r.charCodeAt(i+2))return function(e,t){let r=e.source.body,n=r.length,i=e.lineStart,s=t+3,o=s,a="",c=[];for(;s<n;){let n=r.charCodeAt(s);if(34===n&&34===r.charCodeAt(s+1)&&34===r.charCodeAt(s+2)){a+=r.slice(o,s),c.push(a);let n=r5(e,T.BLOCK_STRING,t,s+3,(function(e){var t,r;let n=Number.MAX_SAFE_INTEGER,i=null,s=-1;for(let t=0;t<e.length;++t){let o=e[t],a=function(e){let t=0;for(;t<e.length&&rW(e.charCodeAt(t));)++t;return t}(o);a!==o.length&&(i=null!==(r=i)&&void 0!==r?r:t,s=t,0!==t&&a<n&&(n=a))}return e.map((e,t)=>0===t?e:e.slice(n)).slice(null!==(t=i)&&void 0!==t?t:0,s+1)})(c).join("\n"));return e.line+=c.length-1,e.lineStart=i,n}if(92===n&&34===r.charCodeAt(s+1)&&34===r.charCodeAt(s+2)&&34===r.charCodeAt(s+3)){a+=r.slice(o,s),o=s+1,s+=4;continue}if(10===n||13===n){a+=r.slice(o,s),c.push(a),13===n&&10===r.charCodeAt(s+1)?s+=2:++s,a="",o=s,i=s;continue}if(r1(n))++s;else if(r2(r,s))s+=2;else throw rq(e.source,s,`Invalid character within String: ${r9(e,s)}.`)}throw rq(e.source,s,"Unterminated string.")}(e,i);return function(e,t){let r=e.source.body,n=r.length,i=t+1,s=i,o="";for(;i<n;){let n=r.charCodeAt(i);if(34===n)return o+=r.slice(s,i),r5(e,T.STRING,t,i+1,o);if(92===n){o+=r.slice(s,i);let t=117===r.charCodeAt(i+1)?123===r.charCodeAt(i+2)?function(e,t){let r=e.source.body,n=0,i=3;for(;i<12;){let e=r.charCodeAt(t+i++);if(125===e){if(i<5||!r1(n))break;return{value:String.fromCodePoint(n),size:i}}if((n=n<<4|r7(e))<0)break}throw rq(e.source,t,`Invalid Unicode escape sequence: "${r.slice(t,t+i)}".`)}(e,i):function(e,t){let r=e.source.body,n=r6(r,t+2);if(r1(n))return{value:String.fromCodePoint(n),size:6};if(r3(n)&&92===r.charCodeAt(t+6)&&117===r.charCodeAt(t+7)){let e=r6(r,t+8);if(r4(e))return{value:String.fromCodePoint(n,e),size:12}}throw rq(e.source,t,`Invalid Unicode escape sequence: "${r.slice(t,t+6)}".`)}(e,i):function(e,t){let r=e.source.body;switch(r.charCodeAt(t+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:"\n",size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw rq(e.source,t,`Invalid character escape sequence: "${r.slice(t,t+2)}".`)}(e,i);o+=t.value,i+=t.size,s=i;continue}if(10===n||13===n)break;if(r1(n))++i;else if(r2(r,i))i+=2;else throw rq(e.source,i,`Invalid character within String: ${r9(e,i)}.`)}throw rq(e.source,i,"Unterminated string.")}(e,i)}if(rQ(t)||45===t)return function(e,t,r){let n=e.source.body,i=t,s=r,o=!1;if(45===s&&(s=n.charCodeAt(++i)),48===s){if(rQ(s=n.charCodeAt(++i)))throw rq(e.source,i,`Invalid number, unexpected digit after 0: ${r9(e,i)}.`)}else i=r8(e,i,s),s=n.charCodeAt(i);if(46===s&&(o=!0,s=n.charCodeAt(++i),i=r8(e,i,s),s=n.charCodeAt(i)),(69===s||101===s)&&(o=!0,(43===(s=n.charCodeAt(++i))||45===s)&&(s=n.charCodeAt(++i)),i=r8(e,i,s),s=n.charCodeAt(i)),46===s||rZ(s))throw rq(e.source,i,`Invalid number, expected digit but got: ${r9(e,i)}.`);return r5(e,o?T.FLOAT:T.INT,t,i,n.slice(t,i))}(e,i,t);if(rZ(t))return function(e,t){let r=e.source.body,n=r.length,i=t+1;for(;i<n;){var s;if(rX(s=r.charCodeAt(i))||rQ(s)||95===s)++i;else break}return r5(e,T.NAME,t,i,r.slice(t,i))}(e,i);throw rq(e.source,i,39===t?"Unexpected single quote character ('), did you mean to use a double quote (\")?":r1(t)||r2(r,i)?`Unexpected character: ${r9(e,i)}.`:`Invalid character: ${r9(e,i)}.`)}return r5(e,T.EOF,n,n)}(this,e.end);e.next=t,t.prev=e,e=t}while(e.kind===T.COMMENT);return e}}function r1(e){return e>=0&&e<=55295||e>=57344&&e<=1114111}function r2(e,t){return r3(e.charCodeAt(t))&&r4(e.charCodeAt(t+1))}function r3(e){return e>=55296&&e<=56319}function r4(e){return e>=56320&&e<=57343}function r9(e,t){let r=e.source.body.codePointAt(t);if(void 0===r)return T.EOF;if(r>=32&&r<=126){let e=String.fromCodePoint(r);return'"'===e?"'\"'":`"${e}"`}return"U+"+r.toString(16).toUpperCase().padStart(4,"0")}function r5(e,t,r,n,i){let s=e.line,o=1+r-e.lineStart;return new rH(t,r,n,s,o,i)}function r8(e,t,r){if(!rQ(r))throw rq(e.source,t,`Invalid number, expected digit but got: ${r9(e,t)}.`);let n=e.source.body,i=t+1;for(;rQ(n.charCodeAt(i));)++i;return i}function r6(e,t){return r7(e.charCodeAt(t))<<12|r7(e.charCodeAt(t+1))<<8|r7(e.charCodeAt(t+2))<<4|r7(e.charCodeAt(t+3))}function r7(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:-1}function ne(e,t){if(!e)throw Error(t)}function nt(e,t){switch(typeof e){case"string":return JSON.stringify(e);case"function":return e.name?`[function ${e.name}]`:"[function]";case"object":return function(e,t){if(null===e)return"null";if(t.includes(e))return"[Circular]";let r=[...t,e];if("function"==typeof e.toJSON){let t=e.toJSON();if(t!==e)return"string"==typeof t?t:nt(t,r)}else if(Array.isArray(e))return function(e,t){if(0===e.length)return"[]";if(t.length>2)return"[Array]";let r=Math.min(10,e.length),n=e.length-r,i=[];for(let n=0;n<r;++n)i.push(nt(e[n],t));return 1===n?i.push("... 1 more item"):n>1&&i.push(`... ${n} more items`),"["+i.join(", ")+"]"}(e,r);return function(e,t){let r=Object.entries(e);return 0===r.length?"{}":t.length>2?"["+function(e){let t=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if("Object"===t&&"function"==typeof e.constructor){let t=e.constructor.name;if("string"==typeof t&&""!==t)return t}return t}(e)+"]":"{ "+r.map(([e,r])=>e+": "+nt(r,t)).join(", ")+" }"}(e,r)}(e,t);default:return String(e)}}let nr=globalThis.process?function(e,t){return e instanceof t}:function(e,t){if(e instanceof t)return!0;if("object"==typeof e&&null!==e){var r;let n=t.prototype[Symbol.toStringTag];if(n===(Symbol.toStringTag in e?e[Symbol.toStringTag]:null===(r=e.constructor)||void 0===r?void 0:r.name)){let t=nt(e,[]);throw Error(`Cannot use ${n} "${t}" from another module or realm.

Ensure that there is only one instance of "graphql" in the node_modules
directory. If different versions of "graphql" are the dependencies of other
relied on modules, use "resolutions" to ensure only one version is installed.

https://yarnpkg.com/en/docs/selective-version-resolutions

Duplicate "graphql" modules cannot be used at the same time since different
versions may have different capabilities and behavior. The data from one
version used in the function from another could produce confusing and
spurious results.`)}}return!1};class nn{constructor(e,t="GraphQL request",r={line:1,column:1}){"string"==typeof e||ne(!1,`Body must be a string. Received: ${nt(e,[])}.`),this.body=e,this.name=t,this.locationOffset=r,this.locationOffset.line>0||ne(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||ne(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}class ni{constructor(e,t={}){let r=nr(e,nn)?e:new nn(e);this._lexer=new r0(r),this._options=t,this._tokenCounter=0}get tokenCount(){return this._tokenCounter}parseName(){let e=this.expectToken(T.NAME);return this.node(e,{kind:g.NAME,value:e.value})}parseDocument(){return this.node(this._lexer.token,{kind:g.DOCUMENT,definitions:this.many(T.SOF,this.parseDefinition,T.EOF)})}parseDefinition(){if(this.peek(T.BRACE_L))return this.parseOperationDefinition();let e=this.peekDescription(),t=e?this._lexer.lookahead():this._lexer.token;if(t.kind===T.NAME){switch(t.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(e)throw rq(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(t.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(t)}parseOperationDefinition(){let e;let t=this._lexer.token;if(this.peek(T.BRACE_L))return this.node(t,{kind:g.OPERATION_DEFINITION,operation:y.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});let r=this.parseOperationType();return this.peek(T.NAME)&&(e=this.parseName()),this.node(t,{kind:g.OPERATION_DEFINITION,operation:r,name:e,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){let e=this.expectToken(T.NAME);switch(e.value){case"query":return y.QUERY;case"mutation":return y.MUTATION;case"subscription":return y.SUBSCRIPTION}throw this.unexpected(e)}parseVariableDefinitions(){return this.optionalMany(T.PAREN_L,this.parseVariableDefinition,T.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:g.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(T.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(T.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){let e=this._lexer.token;return this.expectToken(T.DOLLAR),this.node(e,{kind:g.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:g.SELECTION_SET,selections:this.many(T.BRACE_L,this.parseSelection,T.BRACE_R)})}parseSelection(){return this.peek(T.SPREAD)?this.parseFragment():this.parseField()}parseField(){let e,t;let r=this._lexer.token,n=this.parseName();return this.expectOptionalToken(T.COLON)?(e=n,t=this.parseName()):t=n,this.node(r,{kind:g.FIELD,alias:e,name:t,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(T.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(e){let t=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(T.PAREN_L,t,T.PAREN_R)}parseArgument(e=!1){let t=this._lexer.token,r=this.parseName();return this.expectToken(T.COLON),this.node(t,{kind:g.ARGUMENT,name:r,value:this.parseValueLiteral(e)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){let e=this._lexer.token;this.expectToken(T.SPREAD);let t=this.expectOptionalKeyword("on");return!t&&this.peek(T.NAME)?this.node(e,{kind:g.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(e,{kind:g.INLINE_FRAGMENT,typeCondition:t?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){let e=this._lexer.token;return(this.expectKeyword("fragment"),!0===this._options.allowLegacyFragmentVariables)?this.node(e,{kind:g.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(e,{kind:g.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if("on"===this._lexer.token.value)throw this.unexpected();return this.parseName()}parseValueLiteral(e){let t=this._lexer.token;switch(t.kind){case T.BRACKET_L:return this.parseList(e);case T.BRACE_L:return this.parseObject(e);case T.INT:return this.advanceLexer(),this.node(t,{kind:g.INT,value:t.value});case T.FLOAT:return this.advanceLexer(),this.node(t,{kind:g.FLOAT,value:t.value});case T.STRING:case T.BLOCK_STRING:return this.parseStringLiteral();case T.NAME:switch(this.advanceLexer(),t.value){case"true":return this.node(t,{kind:g.BOOLEAN,value:!0});case"false":return this.node(t,{kind:g.BOOLEAN,value:!1});case"null":return this.node(t,{kind:g.NULL});default:return this.node(t,{kind:g.ENUM,value:t.value})}case T.DOLLAR:if(e){if(this.expectToken(T.DOLLAR),this._lexer.token.kind===T.NAME){let e=this._lexer.token.value;throw rq(this._lexer.source,t.start,`Unexpected variable "$${e}" in constant value.`)}throw this.unexpected(t)}return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){let e=this._lexer.token;return this.advanceLexer(),this.node(e,{kind:g.STRING,value:e.value,block:e.kind===T.BLOCK_STRING})}parseList(e){return this.node(this._lexer.token,{kind:g.LIST,values:this.any(T.BRACKET_L,()=>this.parseValueLiteral(e),T.BRACKET_R)})}parseObject(e){return this.node(this._lexer.token,{kind:g.OBJECT,fields:this.any(T.BRACE_L,()=>this.parseObjectField(e),T.BRACE_R)})}parseObjectField(e){let t=this._lexer.token,r=this.parseName();return this.expectToken(T.COLON),this.node(t,{kind:g.OBJECT_FIELD,name:r,value:this.parseValueLiteral(e)})}parseDirectives(e){let t=[];for(;this.peek(T.AT);)t.push(this.parseDirective(e));return t}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(e){let t=this._lexer.token;return this.expectToken(T.AT),this.node(t,{kind:g.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e)})}parseTypeReference(){let e;let t=this._lexer.token;if(this.expectOptionalToken(T.BRACKET_L)){let r=this.parseTypeReference();this.expectToken(T.BRACKET_R),e=this.node(t,{kind:g.LIST_TYPE,type:r})}else e=this.parseNamedType();return this.expectOptionalToken(T.BANG)?this.node(t,{kind:g.NON_NULL_TYPE,type:e}):e}parseNamedType(){return this.node(this._lexer.token,{kind:g.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(T.STRING)||this.peek(T.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){let e=this._lexer.token,t=this.parseDescription();this.expectKeyword("schema");let r=this.parseConstDirectives(),n=this.many(T.BRACE_L,this.parseOperationTypeDefinition,T.BRACE_R);return this.node(e,{kind:g.SCHEMA_DEFINITION,description:t,directives:r,operationTypes:n})}parseOperationTypeDefinition(){let e=this._lexer.token,t=this.parseOperationType();this.expectToken(T.COLON);let r=this.parseNamedType();return this.node(e,{kind:g.OPERATION_TYPE_DEFINITION,operation:t,type:r})}parseScalarTypeDefinition(){let e=this._lexer.token,t=this.parseDescription();this.expectKeyword("scalar");let r=this.parseName(),n=this.parseConstDirectives();return this.node(e,{kind:g.SCALAR_TYPE_DEFINITION,description:t,name:r,directives:n})}parseObjectTypeDefinition(){let e=this._lexer.token,t=this.parseDescription();this.expectKeyword("type");let r=this.parseName(),n=this.parseImplementsInterfaces(),i=this.parseConstDirectives(),s=this.parseFieldsDefinition();return this.node(e,{kind:g.OBJECT_TYPE_DEFINITION,description:t,name:r,interfaces:n,directives:i,fields:s})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(T.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(T.BRACE_L,this.parseFieldDefinition,T.BRACE_R)}parseFieldDefinition(){let e=this._lexer.token,t=this.parseDescription(),r=this.parseName(),n=this.parseArgumentDefs();this.expectToken(T.COLON);let i=this.parseTypeReference(),s=this.parseConstDirectives();return this.node(e,{kind:g.FIELD_DEFINITION,description:t,name:r,arguments:n,type:i,directives:s})}parseArgumentDefs(){return this.optionalMany(T.PAREN_L,this.parseInputValueDef,T.PAREN_R)}parseInputValueDef(){let e;let t=this._lexer.token,r=this.parseDescription(),n=this.parseName();this.expectToken(T.COLON);let i=this.parseTypeReference();this.expectOptionalToken(T.EQUALS)&&(e=this.parseConstValueLiteral());let s=this.parseConstDirectives();return this.node(t,{kind:g.INPUT_VALUE_DEFINITION,description:r,name:n,type:i,defaultValue:e,directives:s})}parseInterfaceTypeDefinition(){let e=this._lexer.token,t=this.parseDescription();this.expectKeyword("interface");let r=this.parseName(),n=this.parseImplementsInterfaces(),i=this.parseConstDirectives(),s=this.parseFieldsDefinition();return this.node(e,{kind:g.INTERFACE_TYPE_DEFINITION,description:t,name:r,interfaces:n,directives:i,fields:s})}parseUnionTypeDefinition(){let e=this._lexer.token,t=this.parseDescription();this.expectKeyword("union");let r=this.parseName(),n=this.parseConstDirectives(),i=this.parseUnionMemberTypes();return this.node(e,{kind:g.UNION_TYPE_DEFINITION,description:t,name:r,directives:n,types:i})}parseUnionMemberTypes(){return this.expectOptionalToken(T.EQUALS)?this.delimitedMany(T.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){let e=this._lexer.token,t=this.parseDescription();this.expectKeyword("enum");let r=this.parseName(),n=this.parseConstDirectives(),i=this.parseEnumValuesDefinition();return this.node(e,{kind:g.ENUM_TYPE_DEFINITION,description:t,name:r,directives:n,values:i})}parseEnumValuesDefinition(){return this.optionalMany(T.BRACE_L,this.parseEnumValueDefinition,T.BRACE_R)}parseEnumValueDefinition(){let e=this._lexer.token,t=this.parseDescription(),r=this.parseEnumValueName(),n=this.parseConstDirectives();return this.node(e,{kind:g.ENUM_VALUE_DEFINITION,description:t,name:r,directives:n})}parseEnumValueName(){if("true"===this._lexer.token.value||"false"===this._lexer.token.value||"null"===this._lexer.token.value)throw rq(this._lexer.source,this._lexer.token.start,`${ns(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){let e=this._lexer.token,t=this.parseDescription();this.expectKeyword("input");let r=this.parseName(),n=this.parseConstDirectives(),i=this.parseInputFieldsDefinition();return this.node(e,{kind:g.INPUT_OBJECT_TYPE_DEFINITION,description:t,name:r,directives:n,fields:i})}parseInputFieldsDefinition(){return this.optionalMany(T.BRACE_L,this.parseInputValueDef,T.BRACE_R)}parseTypeSystemExtension(){let e=this._lexer.lookahead();if(e.kind===T.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)}parseSchemaExtension(){let e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");let t=this.parseConstDirectives(),r=this.optionalMany(T.BRACE_L,this.parseOperationTypeDefinition,T.BRACE_R);if(0===t.length&&0===r.length)throw this.unexpected();return this.node(e,{kind:g.SCHEMA_EXTENSION,directives:t,operationTypes:r})}parseScalarTypeExtension(){let e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");let t=this.parseName(),r=this.parseConstDirectives();if(0===r.length)throw this.unexpected();return this.node(e,{kind:g.SCALAR_TYPE_EXTENSION,name:t,directives:r})}parseObjectTypeExtension(){let e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");let t=this.parseName(),r=this.parseImplementsInterfaces(),n=this.parseConstDirectives(),i=this.parseFieldsDefinition();if(0===r.length&&0===n.length&&0===i.length)throw this.unexpected();return this.node(e,{kind:g.OBJECT_TYPE_EXTENSION,name:t,interfaces:r,directives:n,fields:i})}parseInterfaceTypeExtension(){let e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");let t=this.parseName(),r=this.parseImplementsInterfaces(),n=this.parseConstDirectives(),i=this.parseFieldsDefinition();if(0===r.length&&0===n.length&&0===i.length)throw this.unexpected();return this.node(e,{kind:g.INTERFACE_TYPE_EXTENSION,name:t,interfaces:r,directives:n,fields:i})}parseUnionTypeExtension(){let e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");let t=this.parseName(),r=this.parseConstDirectives(),n=this.parseUnionMemberTypes();if(0===r.length&&0===n.length)throw this.unexpected();return this.node(e,{kind:g.UNION_TYPE_EXTENSION,name:t,directives:r,types:n})}parseEnumTypeExtension(){let e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");let t=this.parseName(),r=this.parseConstDirectives(),n=this.parseEnumValuesDefinition();if(0===r.length&&0===n.length)throw this.unexpected();return this.node(e,{kind:g.ENUM_TYPE_EXTENSION,name:t,directives:r,values:n})}parseInputObjectTypeExtension(){let e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");let t=this.parseName(),r=this.parseConstDirectives(),n=this.parseInputFieldsDefinition();if(0===r.length&&0===n.length)throw this.unexpected();return this.node(e,{kind:g.INPUT_OBJECT_TYPE_EXTENSION,name:t,directives:r,fields:n})}parseDirectiveDefinition(){let e=this._lexer.token,t=this.parseDescription();this.expectKeyword("directive"),this.expectToken(T.AT);let r=this.parseName(),n=this.parseArgumentDefs(),i=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");let s=this.parseDirectiveLocations();return this.node(e,{kind:g.DIRECTIVE_DEFINITION,description:t,name:r,arguments:n,repeatable:i,locations:s})}parseDirectiveLocations(){return this.delimitedMany(T.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){let e=this._lexer.token,t=this.parseName();if(Object.prototype.hasOwnProperty.call(m,t.value))return t;throw this.unexpected(e)}node(e,t){return!0!==this._options.noLocation&&(t.loc=new rG(e,this._lexer.lastToken,this._lexer.source)),t}peek(e){return this._lexer.token.kind===e}expectToken(e){let t=this._lexer.token;if(t.kind===e)return this.advanceLexer(),t;throw rq(this._lexer.source,t.start,`Expected ${no(e)}, found ${ns(t)}.`)}expectOptionalToken(e){return this._lexer.token.kind===e&&(this.advanceLexer(),!0)}expectKeyword(e){let t=this._lexer.token;if(t.kind===T.NAME&&t.value===e)this.advanceLexer();else throw rq(this._lexer.source,t.start,`Expected "${e}", found ${ns(t)}.`)}expectOptionalKeyword(e){let t=this._lexer.token;return t.kind===T.NAME&&t.value===e&&(this.advanceLexer(),!0)}unexpected(e){let t=null!=e?e:this._lexer.token;return rq(this._lexer.source,t.start,`Unexpected ${ns(t)}.`)}any(e,t,r){this.expectToken(e);let n=[];for(;!this.expectOptionalToken(r);)n.push(t.call(this));return n}optionalMany(e,t,r){if(this.expectOptionalToken(e)){let e=[];do e.push(t.call(this));while(!this.expectOptionalToken(r));return e}return[]}many(e,t,r){this.expectToken(e);let n=[];do n.push(t.call(this));while(!this.expectOptionalToken(r));return n}delimitedMany(e,t){this.expectOptionalToken(e);let r=[];do r.push(t.call(this));while(this.expectOptionalToken(e));return r}advanceLexer(){let{maxTokens:e}=this._options,t=this._lexer.advance();if(t.kind!==T.EOF&&(++this._tokenCounter,void 0!==e&&this._tokenCounter>e))throw rq(this._lexer.source,t.start,`Document contains more that ${e} tokens. Parsing aborted.`)}}function ns(e){let t=e.value;return no(e.kind)+(null!=t?` "${t}"`:"")}function no(e){return e===T.BANG||e===T.DOLLAR||e===T.AMP||e===T.PAREN_L||e===T.PAREN_R||e===T.SPREAD||e===T.COLON||e===T.EQUALS||e===T.AT||e===T.BRACKET_L||e===T.BRACKET_R||e===T.BRACE_L||e===T.PIPE||e===T.BRACE_R?`"${e}"`:e}let na=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function nc(e){return nl[e.charCodeAt(0)]}let nl=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],nu=Object.freeze({}),nh={Name:{leave:e=>e.value},Variable:{leave:e=>"$"+e.name},Document:{leave:e=>nd(e.definitions,"\n\n")},OperationDefinition:{leave(e){let t=nf("(",nd(e.variableDefinitions,", "),")"),r=nd([e.operation,nd([e.name,t]),nd(e.directives," ")]," ");return("query"===r?"":r+" ")+e.selectionSet}},VariableDefinition:{leave:({variable:e,type:t,defaultValue:r,directives:n})=>e+": "+t+nf(" = ",r)+nf(" ",nd(n," "))},SelectionSet:{leave:({selections:e})=>np(e)},Field:{leave({alias:e,name:t,arguments:r,directives:n,selectionSet:i}){let s=nf("",e,": ")+t,o=s+nf("(",nd(r,", "),")");return o.length>80&&(o=s+nf("(\n",nv(nd(r,"\n")),"\n)")),nd([o,nd(n," "),i]," ")}},Argument:{leave:({name:e,value:t})=>e+": "+t},FragmentSpread:{leave:({name:e,directives:t})=>"..."+e+nf(" ",nd(t," "))},InlineFragment:{leave:({typeCondition:e,directives:t,selectionSet:r})=>nd(["...",nf("on ",e),nd(t," "),r]," ")},FragmentDefinition:{leave:({name:e,typeCondition:t,variableDefinitions:r,directives:n,selectionSet:i})=>`fragment ${e}${nf("(",nd(r,", "),")")} on ${t} ${nf("",nd(n," ")," ")}`+i},IntValue:{leave:({value:e})=>e},FloatValue:{leave:({value:e})=>e},StringValue:{leave:({value:e,block:t})=>t?function(e,t){let r=e.replace(/"""/g,'\\"""'),n=r.split(/\r\n|[\n\r]/g),i=1===n.length,s=n.length>1&&n.slice(1).every(e=>0===e.length||rW(e.charCodeAt(0))),o=r.endsWith('\\"""'),a=e.endsWith('"')&&!o,c=e.endsWith("\\"),l=a||c,u=!i||e.length>70||l||s||o,h="",d=i&&rW(e.charCodeAt(0));return(u&&!d||s)&&(h+="\n"),h+=r,(u||l)&&(h+="\n"),'"""'+h+'"""'}(e):`"${e.replace(na,nc)}"`},BooleanValue:{leave:({value:e})=>e?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:e})=>e},ListValue:{leave:({values:e})=>"["+nd(e,", ")+"]"},ObjectValue:{leave:({fields:e})=>"{"+nd(e,", ")+"}"},ObjectField:{leave:({name:e,value:t})=>e+": "+t},Directive:{leave:({name:e,arguments:t})=>"@"+e+nf("(",nd(t,", "),")")},NamedType:{leave:({name:e})=>e},ListType:{leave:({type:e})=>"["+e+"]"},NonNullType:{leave:({type:e})=>e+"!"},SchemaDefinition:{leave:({description:e,directives:t,operationTypes:r})=>nf("",e,"\n")+nd(["schema",nd(t," "),np(r)]," ")},OperationTypeDefinition:{leave:({operation:e,type:t})=>e+": "+t},ScalarTypeDefinition:{leave:({description:e,name:t,directives:r})=>nf("",e,"\n")+nd(["scalar",t,nd(r," ")]," ")},ObjectTypeDefinition:{leave:({description:e,name:t,interfaces:r,directives:n,fields:i})=>nf("",e,"\n")+nd(["type",t,nf("implements ",nd(r," & ")),nd(n," "),np(i)]," ")},FieldDefinition:{leave:({description:e,name:t,arguments:r,type:n,directives:i})=>nf("",e,"\n")+t+(ny(r)?nf("(\n",nv(nd(r,"\n")),"\n)"):nf("(",nd(r,", "),")"))+": "+n+nf(" ",nd(i," "))},InputValueDefinition:{leave:({description:e,name:t,type:r,defaultValue:n,directives:i})=>nf("",e,"\n")+nd([t+": "+r,nf("= ",n),nd(i," ")]," ")},InterfaceTypeDefinition:{leave:({description:e,name:t,interfaces:r,directives:n,fields:i})=>nf("",e,"\n")+nd(["interface",t,nf("implements ",nd(r," & ")),nd(n," "),np(i)]," ")},UnionTypeDefinition:{leave:({description:e,name:t,directives:r,types:n})=>nf("",e,"\n")+nd(["union",t,nd(r," "),nf("= ",nd(n," | "))]," ")},EnumTypeDefinition:{leave:({description:e,name:t,directives:r,values:n})=>nf("",e,"\n")+nd(["enum",t,nd(r," "),np(n)]," ")},EnumValueDefinition:{leave:({description:e,name:t,directives:r})=>nf("",e,"\n")+nd([t,nd(r," ")]," ")},InputObjectTypeDefinition:{leave:({description:e,name:t,directives:r,fields:n})=>nf("",e,"\n")+nd(["input",t,nd(r," "),np(n)]," ")},DirectiveDefinition:{leave:({description:e,name:t,arguments:r,repeatable:n,locations:i})=>nf("",e,"\n")+"directive @"+t+(ny(r)?nf("(\n",nv(nd(r,"\n")),"\n)"):nf("(",nd(r,", "),")"))+(n?" repeatable":"")+" on "+nd(i," | ")},SchemaExtension:{leave:({directives:e,operationTypes:t})=>nd(["extend schema",nd(e," "),np(t)]," ")},ScalarTypeExtension:{leave:({name:e,directives:t})=>nd(["extend scalar",e,nd(t," ")]," ")},ObjectTypeExtension:{leave:({name:e,interfaces:t,directives:r,fields:n})=>nd(["extend type",e,nf("implements ",nd(t," & ")),nd(r," "),np(n)]," ")},InterfaceTypeExtension:{leave:({name:e,interfaces:t,directives:r,fields:n})=>nd(["extend interface",e,nf("implements ",nd(t," & ")),nd(r," "),np(n)]," ")},UnionTypeExtension:{leave:({name:e,directives:t,types:r})=>nd(["extend union",e,nd(t," "),nf("= ",nd(r," | "))]," ")},EnumTypeExtension:{leave:({name:e,directives:t,values:r})=>nd(["extend enum",e,nd(t," "),np(r)]," ")},InputObjectTypeExtension:{leave:({name:e,directives:t,fields:r})=>nd(["extend input",e,nd(t," "),np(r)]," ")}};function nd(e,t=""){var r;return null!==(r=null==e?void 0:e.filter(e=>e).join(t))&&void 0!==r?r:""}function np(e){return nf("{\n",nv(nd(e,"\n")),"\n}")}function nf(e,t,r=""){return null!=t&&""!==t?e+t+r:""}function nv(e){return nf("  ",e.replace(/\n/g,"\n  "))}function ny(e){var t;return null!==(t=null==e?void 0:e.some(e=>e.includes("\n")))&&void 0!==t&&t}var nm=r(3454);function ng(e){var t;let r;let n=e.definitions.filter(e=>"OperationDefinition"===e.kind);return 1===n.length&&(r=null==(t=n[0].name)?void 0:t.value),r}class nT{constructor(e){this.headers={},this.isAccessTokenValidOrNull=()=>{if(!this.accessToken)return!0;try{let e=w(this.accessToken);return null!=e.exp&&1e3*e.exp>Date.now()}catch(e){return console.error("Error decoding token:",e),!1}},this.awaitForValidAccessTokenOrNull=async()=>{if(this.isAccessTokenValidOrNull())return!0;let e=()=>this.isAccessTokenValidOrNull()?Promise.resolve(!0):new Promise(t=>{setTimeout(()=>e().then(t),100)});return e()};let{url:t,adminSecret:r}=e;this._url=t,this.accessToken=null,this.adminSecret=r}async request(e,...t){let[r,n]=t,i=e.document?e:{document:e,variables:r,config:n},{headers:s,...o}=n||{},{query:a,operationName:c}=function(e){if("string"==typeof e){let t;try{let r=function(e,t){let r=new ni(e,void 0),n=r.parseDocument();return Object.defineProperty(n,"tokenCount",{enumerable:!1,value:r.tokenCount}),n}(e);t=ng(r)}catch{}return{query:e,operationName:t}}let t=ng(e);return{query:function(e,t,r=rY){let n,i,s;let o=new Map;for(let e of Object.values(g))o.set(e,function(e,t){let r=e[t];return"object"==typeof r?r:"function"==typeof r?{enter:r,leave:void 0}:{enter:e.enter,leave:e.leave}}(t,e));let a=Array.isArray(e),c=[e],l=-1,u=[],h=e,d=[],p=[];do{var f,v,y;let e;let m=++l===c.length,g=m&&0!==u.length;if(m){if(i=0===p.length?void 0:d[d.length-1],h=s,s=p.pop(),g){if(a){h=h.slice();let e=0;for(let[t,r]of u){let n=t-e;null===r?(h.splice(n,1),e++):h[n]=r}}else for(let[e,t]of(h={...h},u))h[e]=t}l=n.index,c=n.keys,u=n.edits,a=n.inArray,n=n.prev}else if(s){if(null==(h=s[i=a?l:c[l]]))continue;d.push(i)}if(!Array.isArray(h)){rJ(h)||ne(!1,`Invalid AST Node: ${nt(h,[])}.`);let r=m?null===(f=o.get(h.kind))||void 0===f?void 0:f.leave:null===(v=o.get(h.kind))||void 0===v?void 0:v.enter;if((e=null==r?void 0:r.call(t,h,i,s,d,p))===nu)break;if(!1===e){if(!m){d.pop();continue}}else if(void 0!==e&&(u.push([i,e]),!m)){if(rJ(e))h=e;else{d.pop();continue}}}void 0===e&&g&&u.push([i,h]),m?d.pop():(n={inArray:a,index:l,keys:c,edits:u,prev:n},c=(a=Array.isArray(h))?h:null!==(y=r[h.kind])&&void 0!==y?y:[],l=-1,u=[],s&&p.push(s),s=h)}while(void 0!==n);return 0!==u.length?u[u.length-1][1]:e}(e,nh),operationName:t}}(i.document);void 0===nm||nm.env.TEST_MODE||await this.awaitForValidAccessTokenOrNull();try{let e=await rM()(this.httpUrl,{method:"POST",body:JSON.stringify({operationName:c,query:a,variables:r}),headers:{"Content-Type":"application/json",...this.generateAccessTokenHeaders(),...this.headers,...s},...o});if(!e.ok)return{data:null,error:{error:e.statusText,message:e.statusText,status:e.status}};let{data:t,errors:n}=await e.json();return n?{data:null,error:n}:"object"!=typeof t||Array.isArray(t)||null===t?{data:null,error:{error:"invalid-response",message:"incorrect response data from GraphQL server",status:0}}:{data:t,error:null}}catch(e){return{data:null,error:{message:e.message,status:"AbortError"===e.name?0:500,error:"AbortError"===e.name?"abort-error":"unknown"}}}}get httpUrl(){return this._url}get wsUrl(){return this._url.replace(/^(http)(s?):\/\//,"ws$2://")}get url(){return this._url}getUrl(){return this._url}setAccessToken(e){if(!e){this.accessToken=null;return}this.accessToken=e}getHeaders(){return this.headers}setHeaders(e){e&&(this.headers={...this.headers,...e})}unsetHeaders(){let e=this.headers["x-hasura-role"];this.headers=e?{"x-hasura-role":e}:{}}generateAccessTokenHeaders(){return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:this.accessToken?{Authorization:`Bearer ${this.accessToken}`}:{}}}var nE=r(3454),nS=Object.defineProperty,nw=(e,t,r)=>t in e?nS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,nk=(e,t,r)=>nw(e,"symbol"!=typeof t?t+"":t,r);let nb=/^((?<protocol>http[s]?):\/\/)?(?<host>(localhost|local))(:(?<port>(\d+|__\w+__)))?$/;function nx(e,t){let{subdomain:r,region:n}=e;if(!r)throw Error("A `subdomain` must be set.");let i=r.match(nb);if(null!=i&&i.groups){let{protocol:e,host:r,port:n}=i.groups;return("undefined"==typeof window&&void 0!==nE&&nE.env?nE.env[`NHOST_${t.toUpperCase()}_URL`]:null)||("localhost"===r?(console.warn('The `subdomain` is set to "localhost". Support for this will be removed in a future release. Please use "local" instead.'),`${e||"http"}://localhost:${n||1337}/v1/${t}`):n?`${e||"https"}://local.${t}.local.nhost.run:${n}/v1`:`${e||"https"}://local.${t}.local.nhost.run/v1`)}if(!n)throw Error('`region` must be set when using a `subdomain` other than "local".');return`https://${r}.${t}.${n}.nhost.run/v1`}class nI{constructor(e){nk(this,"url"),nk(this,"accessToken"),nk(this,"adminSecret"),nk(this,"headers",{});let{url:t,adminSecret:r}=e;this.url=t,this.accessToken=null,this.adminSecret=r}async call(e,t,r){var n,i;let s={"Content-Type":"application/json",...this.generateAccessTokenHeaders(),...null==r?void 0:r.headers,...this.headers},o=this.url+(e.startsWith("/")?e:`/${e}`);try{let e=await rM()(o,{body:t?JSON.stringify(t):null,headers:s,method:"POST"});if(!e.ok){let t;return t=null!=(n=e.headers.get("content-type"))&&n.includes("application/json")?await e.json():await e.text(),{res:null,error:{message:t,error:e.statusText,status:e.status}}}return{res:{data:null!=(i=e.headers.get("content-type"))&&i.includes("application/json")?await e.json():await e.text(),status:e.status,statusText:e.statusText},error:null}}catch(e){return{res:null,error:{message:e.message,status:"AbortError"===e.name?0:500,error:"AbortError"===e.name?"abort-error":"unknown"}}}}setAccessToken(e){if(!e){this.accessToken=null;return}this.accessToken=e}getHeaders(){return this.headers}setHeaders(e){e&&(this.headers={...this.headers,...e})}unsetHeaders(){let e=this.headers["x-hasura-role"];this.headers=e?{"x-hasura-role":e}:{}}generateAccessTokenHeaders(){return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:this.accessToken?{Authorization:`Bearer ${this.accessToken}`}:{}}}class nA{constructor({refreshIntervalTime:e,clientStorage:t,clientStorageType:r,autoRefreshToken:n,autoSignIn:i,adminSecret:s,devTools:o,start:a=!0,...c}){nk(this,"auth"),nk(this,"storage"),nk(this,"functions"),nk(this,"graphql"),nk(this,"_adminSecret"),nk(this,"devTools"),this.auth=function(e){let t="subdomain"in e?nx(e,"auth"):e.authUrl,{subdomain:r,region:n}=e;if(!t)throw Error("Please provide `subdomain` or `authUrl`.");return new rk({url:t,broadcastKey:`${r}${null!=n?n:"local"}`,...e})}({refreshIntervalTime:e,clientStorage:t,clientStorageType:r,autoRefreshToken:n,autoSignIn:i,start:a,...c}),this.storage=function(e){let t="subdomain"in e?nx(e,"storage"):e.storageUrl;if(!t)throw Error("Please provide `subdomain` or `storageUrl`.");return new rC({url:t,...e})}({adminSecret:s,...c}),this.functions=function(e){let t="subdomain"in e?nx(e,"functions"):e.functionsUrl;if(!t)throw Error("Please provide `subdomain` or `functionsUrl`.");return new nI({url:t,...e})}({adminSecret:s,...c}),this.graphql=function(e){let t="subdomain"in e?nx(e,"graphql"):e.graphqlUrl;if(!t)throw Error("Please provide `subdomain` or `graphqlUrl`.");return new nT({url:t,...e})}({adminSecret:s,...c}),this.auth.onAuthStateChanged((e,t)=>{if("SIGNED_OUT"===e){this.storage.setAccessToken(void 0),this.functions.setAccessToken(void 0),this.graphql.setAccessToken(void 0);return}let r=null==t?void 0:t.accessToken;this.storage.setAccessToken(r),this.functions.setAccessToken(r),this.graphql.setAccessToken(r)}),this.auth.onTokenChanged(e=>{let t=null==e?void 0:e.accessToken;this.storage.setAccessToken(t),this.functions.setAccessToken(t),this.graphql.setAccessToken(t)}),this._adminSecret=s,this.devTools=o}get adminSecret(){return this._adminSecret}set adminSecret(e){this._adminSecret=e,this.storage.setAdminSecret(e)}setRole(e){this.graphql.setHeaders({"x-hasura-role":e}),this.storage.setHeaders({"x-hasura-role":e}),this.functions.setHeaders({"x-hasura-role":e})}unsetRole(){this.graphql.setHeaders((({"x-hasura-role":e,...t})=>t)(this.graphql.getHeaders())),this.storage.setHeaders((({"x-hasura-role":e,...t})=>t)(this.storage.getHeaders())),this.functions.setHeaders((({"x-hasura-role":e,...t})=>t)(this.functions.getHeaders()))}}},7559:function(e,t,r){var n;!function(i){"use strict";function s(e){var r,n=e&&e.Promise||i.Promise,s=e&&e.XMLHttpRequest||i.XMLHttpRequest;return r=Object.create(i,{fetch:{value:void 0,writable:!0}}),function(e){var t=void 0!==r&&r||"undefined"!=typeof self&&self||void 0!==t&&t,i={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(i.arrayBuffer)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};function c(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw TypeError("Invalid character in header field name");return e.toLowerCase()}function l(e){return"string"!=typeof e&&(e=String(e)),e}function u(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i.iterable&&(t[Symbol.iterator]=function(){return t}),t}function h(e){this.map={},e instanceof h?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function d(e){if(e.bodyUsed)return n.reject(TypeError("Already read"));e.bodyUsed=!0}function p(e){return new n(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function f(e){var t=new FileReader,r=p(t);return t.readAsArrayBuffer(e),r}function v(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){if(this.bodyUsed=this.bodyUsed,this._bodyInit=e,e){if("string"==typeof e)this._bodyText=e;else if(i.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(i.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(i.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else{var t;i.arrayBuffer&&i.blob&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=v(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):i.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||a(e))?this._bodyArrayBuffer=v(e):this._bodyText=e=Object.prototype.toString.call(e)}}else this._bodyText="";!this.headers.get("content-type")&&("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i.blob&&(this.blob=function(){var e=d(this);if(e)return e;if(this._bodyBlob)return n.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return n.resolve(new Blob([this._bodyArrayBuffer]));if(!this._bodyFormData)return n.resolve(new Blob([this._bodyText]));throw Error("could not read FormData body as blob")},this.arrayBuffer=function(){return this._bodyArrayBuffer?d(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?n.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):n.resolve(this._bodyArrayBuffer)):this.blob().then(f)}),this.text=function(){var e,t,r,i=d(this);if(i)return i;if(this._bodyBlob)return e=this._bodyBlob,r=p(t=new FileReader),t.readAsText(e),r;if(this._bodyArrayBuffer)return n.resolve(function(e){for(var t=new Uint8Array(e),r=Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(!this._bodyFormData)return n.resolve(this._bodyText);throw Error("could not read FormData body as text")},i.formData&&(this.formData=function(){return this.text().then(T)}),this.json=function(){return this.text().then(JSON.parse)},this}h.prototype.append=function(e,t){e=c(e),t=l(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},h.prototype.delete=function(e){delete this.map[c(e)]},h.prototype.get=function(e){return e=c(e),this.has(e)?this.map[e]:null},h.prototype.has=function(e){return this.map.hasOwnProperty(c(e))},h.prototype.set=function(e,t){this.map[c(e)]=l(t)},h.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},h.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),u(e)},h.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),u(e)},h.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),u(e)},i.iterable&&(h.prototype[Symbol.iterator]=h.prototype.entries);var m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function g(e,t){if(!(this instanceof g))throw TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var r,n,i=(t=t||{}).body;if(e instanceof g){if(e.bodyUsed)throw TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new h(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",(t.headers||!this.headers)&&(this.headers=new h(t.headers)),this.method=(n=(r=t.method||this.method||"GET").toUpperCase(),m.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(i),("GET"===this.method||"HEAD"===this.method)&&("no-store"===t.cache||"no-cache"===t.cache)){var s=/([?&])_=[^&]*/;s.test(this.url)?this.url=this.url.replace(s,"$1_="+new Date().getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+new Date().getTime()}}function T(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}}),t}function E(e,t){if(!(this instanceof E))throw TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"",this.headers=new h(t.headers),this.url=t.url||"",this._initBody(e)}g.prototype.clone=function(){return new g(this,{body:this._bodyInit})},y.call(g.prototype),y.call(E.prototype),E.prototype.clone=function(){return new E(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},E.error=function(){var e=new E(null,{status:0,statusText:""});return e.type="error",e};var S=[301,302,303,307,308];E.redirect=function(e,t){if(-1===S.indexOf(t))throw RangeError("Invalid status code");return new E(null,{status:t,headers:{location:e}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function w(r,o){return new n(function(n,a){var c=new g(r,o);if(c.signal&&c.signal.aborted)return a(new e.DOMException("Aborted","AbortError"));var u=new s;function d(){u.abort()}u.onload=function(){var e,t,r={status:u.status,statusText:u.statusText,headers:(e=u.getAllResponseHeaders()||"",t=new h,e.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e}).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();t.append(n,i)}}),t)};r.url="responseURL"in u?u.responseURL:r.headers.get("X-Request-URL");var i="response"in u?u.response:u.responseText;setTimeout(function(){n(new E(i,r))},0)},u.onerror=function(){setTimeout(function(){a(TypeError("Network request failed"))},0)},u.ontimeout=function(){setTimeout(function(){a(TypeError("Network request failed"))},0)},u.onabort=function(){setTimeout(function(){a(new e.DOMException("Aborted","AbortError"))},0)},u.open(c.method,function(e){try{return""===e&&t.location.href?t.location.href:e}catch(t){return e}}(c.url),!0),"include"===c.credentials?u.withCredentials=!0:"omit"===c.credentials&&(u.withCredentials=!1),"responseType"in u&&(i.blob?u.responseType="blob":i.arrayBuffer&&c.headers.get("Content-Type")&&-1!==c.headers.get("Content-Type").indexOf("application/octet-stream")&&(u.responseType="arraybuffer")),!o||"object"!=typeof o.headers||o.headers instanceof h?c.headers.forEach(function(e,t){u.setRequestHeader(t,e)}):Object.getOwnPropertyNames(o.headers).forEach(function(e){u.setRequestHeader(e,l(o.headers[e]))}),c.signal&&(c.signal.addEventListener("abort",d),u.onreadystatechange=function(){4===u.readyState&&c.signal.removeEventListener("abort",d)}),u.send(void 0===c._bodyInit?null:c._bodyInit)})}w.polyfill=!0,t.fetch||(t.fetch=w,t.Headers=h,t.Request=g,t.Response=E),e.Headers=h,e.Request=g,e.Response=E,e.fetch=w,Object.defineProperty(e,"__esModule",{value:!0})}(t),{fetch:r.fetch,Headers:r.Headers,Request:r.Request,Response:r.Response,DOMException:r.DOMException}}void 0!==(n=(function(){return s}).call(t,r,t,e))&&(e.exports=n)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:void 0!==r.g?r.g:this)},6230:function(e){"use strict";e.exports="object"==typeof self?self.FormData:window.FormData},3144:function(e){"use strict";let t=self.fetch.bind(self);e.exports=t,e.exports.default=e.exports},1:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(7294),i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),o=(e,t)=>{let r=(0,n.forwardRef)((r,o)=>{let{color:a="currentColor",size:c=24,strokeWidth:l=2,absoluteStrokeWidth:u,className:h="",children:d,...p}=r;return(0,n.createElement)("svg",{ref:o,...i,width:c,height:c,stroke:a,strokeWidth:u?24*Number(l)/Number(c):l,className:["lucide","lucide-".concat(s(e)),h].join(" "),...p},[...t.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(d)?d:[d]])});return r.displayName="".concat(e),r}},8335:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(1).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},2922:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(1).Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},9972:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(1).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])}}]);