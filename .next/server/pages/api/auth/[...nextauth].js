"use strict";(()=>{var e={};e.id=3748,e.ids=[3748],e.modules={8432:e=>{e.exports=require("bcryptjs")},3227:e=>{e.exports=require("next-auth")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},5900:e=>{e.exports=require("pg")},7692:(e,r,a)=>{a.r(r),a.d(r,{config:()=>o,default:()=>n,routeModule:()=>d});var t=a(1802),i=a(7153),l=a(6249),s=a(3515);let n=(0,l.l)(s,"default"),o=(0,l.l)(s,"config"),d=new t.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/auth/[...nextauth]",pathname:"/api/auth/[...nextauth]",bundlePath:"",filename:""},userland:s})},946:(e,r,a)=>{a.d(r,{qS:()=>t});let t=new(require("@nhost/nhost-js")).NhostClient({subdomain:"sbpnfqrsnvtyvkgldcco",region:"eu-central-1"});parseInt("5432")},3515:(e,r,a)=>{a.r(r),a.d(r,{authOptions:()=>o,default:()=>d});var t=a(3227),i=a.n(t);let l=require("next-auth/providers/credentials");var s=a.n(l);a(946);var n=a(7725);let o={providers:[s()({name:"credentials",credentials:{identifier:{label:"Email or Phone",type:"text"},password:{label:"Password",type:"password"}},async authorize(e){if(console.log("\uD83D\uDD10 NextAuth authorize called with:",{identifier:e?.identifier}),!e?.identifier||!e?.password)return console.log("❌ Missing credentials"),null;try{e.identifier.includes("@"),console.log("⏭️ Nhost authentication skipped (phone login or NEXT_PUBLIC_USE_NHOST=false)"),console.log("\uD83D\uDD04 Using direct database authentication for:",e.identifier);let r=await n.H.findUserByEmailOrPhone(e.identifier);if(!r)throw console.log("❌ User not found in database"),Error("Invalid credentials");if(!await n.H.verifyPasswordByEmailOrPhone(e.identifier,e.password))throw console.log("❌ Invalid password"),Error("Invalid credentials");return console.log("✅ Direct database authentication successful"),{id:r.id,email:r.email,name:r.display_name,phone:r.phone||"",walletBalance:r.walletBalance||0,bonusWallet:r.bonusWallet||0,totalReferrals:r.totalReferrals||0,referralCode:r.referralCode||"",emailVerified:!!r.emailVerified}}catch(e){return console.error("Authentication error:",e),null}}})],session:{strategy:"jwt",maxAge:2592e3},callbacks:{jwt:async({token:e,user:r})=>(r&&(e.id=r.id,e.phone=r.phone,e.walletBalance=r.walletBalance,e.bonusWallet=r.bonusWallet,e.totalReferrals=r.totalReferrals,e.referralCode=r.referralCode,e.emailVerified=!!r.emailVerified,e.accessToken=r.accessToken,e.refreshToken=r.refreshToken),e),session:async({session:e,token:r})=>(r&&(e.user.id=r.id,e.user.phone=r.phone,e.user.walletBalance=r.walletBalance,e.user.bonusWallet=r.bonusWallet,e.user.totalReferrals=r.totalReferrals,e.user.referralCode=r.referralCode,e.user.emailVerified=r.emailVerified,e.accessToken=r.accessToken,e.refreshToken=r.refreshToken),e)},pages:{signIn:"/login",error:"/auth/error"},secret:process.env.NEXTAUTH_SECRET},d=i()(o)}};var r=require("../../../webpack-api-runtime.js");r.C(e);var a=e=>r(r.s=e),t=r.X(0,[2002],()=>a(7692));module.exports=t})();